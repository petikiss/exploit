<!DOCTYPE html><html lang="en-US"><head>  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=!0;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f)})(window,document,'script','dataLayer','GTM-KC95766')</script> <meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta http-equiv="cache-control" content="max-age=0" /><meta http-equiv="cache-control" content="no-cache" /><meta http-equiv="expires" content="0" /><meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" /><meta http-equiv="pragma" content="no-cache" /><link rel="icon" type="image/png" href="https://intezer.com/wp-content/themes/intezer-v2/favicon.png" /><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet"> <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=128260767783916&ev=PageView&noscript=1" /></noscript><title>Intezer - Executable and Linkable Format 101 Part 4: Dynamic Linking</title><meta name="description" content="In part four of our ELF 101 blog series, we explain the dynamic linking process, including its purpose, how it works and the different linking modes."/><meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/><link rel="canonical" href="https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/" /><meta property="og:locale" content="en_US" /><meta property="og:type" content="article" /><meta property="og:description" content="In part four of our ELF 101 blog series, we explain the dynamic linking process, including its purpose, how it works and the different linking modes." /><meta property="og:url" content="https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/" /><meta property="og:site_name" content="Intezer" /><meta property="article:publisher" content="http://@IntezerLabs" /><meta property="article:tag" content="ELF" /><meta property="article:tag" content="Linux" /><meta property="article:tag" content="Research" /><meta property="article:section" content="ELF" /><meta property="article:published_time" content="2019-06-25T14:33:35+00:00" /><meta property="article:modified_time" content="2020-03-26T10:21:16+00:00" /><meta property="og:updated_time" content="2020-03-26T10:21:16+00:00" /><meta property="og:image" content="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg" /><meta property="og:image:secure_url" content="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg" /><meta property="og:image:width" content="1000" /><meta property="og:image:height" content="667" /><meta name="twitter:card" content="summary" /><meta name="twitter:description" content="In part four of our ELF 101 blog series, we explain the dynamic linking process, including its purpose, how it works and the different linking modes." /><meta name="twitter:title" content="Intezer - Executable and Linkable Format 101 Part 4: Dynamic Linking" /><meta name="twitter:site" content="@IntezerLabs" /><meta name="twitter:image" content="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg" /><meta name="twitter:creator" content="@IntezerLabs" /> <script type='application/ld+json' class='yoast-schema-graph yoast-schema-graph--main'>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://intezer.com/#website","url":"https://intezer.com/","name":"Intezer","inLanguage":"en-US","potentialAction":[{"@type":"SearchAction","target":"https://intezer.com/?s={search_term_string}","query-input":"required name=search_term_string"}]},{"@type":"ImageObject","@id":"https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/#primaryimage","inLanguage":"en-US","url":"https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg","width":1000,"height":667,"caption":"ELF"},{"@type":"WebPage","@id":"https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/#webpage","url":"https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/","name":"Intezer - Executable and Linkable Format 101 Part 4: Dynamic Linking","isPartOf":{"@id":"https://intezer.com/#website"},"inLanguage":"en-US","primaryImageOfPage":{"@id":"https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/#primaryimage"},"datePublished":"2019-06-25T14:33:35+00:00","dateModified":"2020-03-26T10:21:16+00:00","author":{"@id":"https://intezer.com/#/schema/person/7aa33f4d009c4cd2e8c677fcc8fa45ec"},"description":"In part four of our ELF 101 blog series, we explain the dynamic linking process, including its purpose, how it works and the different linking modes.","potentialAction":[{"@type":"ReadAction","target":["https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/"]}]},{"@type":["Person"],"@id":"https://intezer.com/#/schema/person/7aa33f4d009c4cd2e8c677fcc8fa45ec","name":"Paul Litvak","image":{"@type":"ImageObject","@id":"https://intezer.com/#authorlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/d9e4a73ab4d11572b62adeabc005ded0?s=96&d=mm&r=g","caption":"Paul Litvak"},"sameAs":[]}]}</script> <link rel='dns-prefetch' href='//www.google.com' /><link rel="alternate" type="application/rss+xml" title="Intezer &raquo; Feed" href="https://intezer.com/feed/" /><link rel="alternate" type="application/rss+xml" title="Intezer &raquo; Comments Feed" href="https://intezer.com/comments/feed/" /><link rel="alternate" type="application/rss+xml" title="Intezer &raquo; Executable and Linkable Format 101 Part 4: Dynamic Linking Comments Feed" href="https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/feed/" /><link rel='stylesheet' id='wp-block-library-css'  href='https://intezer.com/wp-includes/css/dist/block-library/style.min.css?ver=5.3.2' media='all' /><link data-minify="1" rel='stylesheet' id='contact-form-7-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/contact-form-7/includes/css/styles-58f1988c24372a90445566506572b6e8.css' media='all' /><link data-minify="1" rel='stylesheet' id='bootstrap_css-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/themes/intezer-v2/css/bootstrap-77f4789737eddcd7b86865f831aca83a.css' media='all' /><link rel='stylesheet' id='fontawesome_css-css'  href='https://intezer.com/wp-content/themes/intezer-v2/css/font-awesome.min.css?ver=5.3.2' media='all' /><link data-minify="1" rel='stylesheet' id='main_css-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/themes/intezer-v2/style-b6ee4d7da6c603e1c306a9787271b107.css' media='all' /><link data-minify="1" rel='stylesheet' id='slb_core-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/simple-lightbox/client/css/app-df3bdc18a0d5ffe57a5b276454890a68.css' media='all' /><link rel='stylesheet' id='addtoany-css'  href='https://intezer.com/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' media='all' /><link data-minify="1" rel='stylesheet' id='cf7cf-style-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/cf7-conditional-fields/style-678fd78ee455b3d3b38e874ec117933c.css' media='all' /><link rel='https://api.w.org/' href='https://intezer.com/wp-json/' /><link rel='shortlink' href='https://intezer.com/?p=4736' /><link rel="alternate" type="application/json+oembed" href="https://intezer.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-linkable-format-101-part-4-dynamic-linking%2F" /><link rel="alternate" type="text/xml+oembed" href="https://intezer.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-linkable-format-101-part-4-dynamic-linking%2F&#038;format=xml" /><link data-minify="1" rel="stylesheet" href="https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/wp-synhighlight/themes/default/wp-synhighlighter-2fc04b6d82a5761012ae19436bfc1091.css" type="text/css" media="screen" /><link rel="icon" href="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-32x32.png" sizes="32x32" /><link rel="icon" href="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-192x192.png" sizes="192x192" /><link rel="apple-touch-icon-precomposed" href="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-180x180.png" /><meta name="msapplication-TileImage" content="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-270x270.png" /><style type="text/css" id="wp-custom-css">footer .footer-1{flex-direction:row}footer .footer-1>li{min-width:auto;padding:0 10px}#contact-us input,#contact-us textarea{color:#757575}#whitepaper-form input,#whitepaper-form textarea{color:#757575}#technology-4 h2{font-size:45px;color:#000;font-family:"Museo300",sans-serif;margin:0 0 20px 0}#technology-4 p{font-size:19px;color:#505157;line-height:1.5;max-width:90%;display:inline-block;font-weight:300}.owl-carousel .owl-nav .owl-prev,.owl-carousel .owl-nav .owl-next,.owl-carousel .owl-dot{font-family:'fontAwesome'}.owl-carousel .owl-nav .owl-prev:before{content:"\f053";float:left;position:absolute;left:-60px;top:60px;opacity:.3}.owl-carousel .owl-nav .owl-next:after{content:"\f054";float:right;position:absolute;right:-60px;top:60px;opacity:.3}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner{max-width:1140px!important;padding:0 10px!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-confirmation-button{margin-top:10px}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p{width:85%;float:left;font-size:15px}.wpcf7 p{margin-bottom:0}.cf-field{float:left;width:50%;padding-left:5px;padding-right:0}.cf-field-left{padding-left:0;padding-right:5px}.cf-field.cf-field-wide{width:100%;padding:0}@media (min-width:640px) and (max-width:1350px){.meta-date strong,.meta-date span{margin-top:5px;margin-bottom:25px}}@media (max-width:900px){.meta-date strong,.meta-date span{margin-top:1rem}#technology-4 h2{font-size:35px}}@media (max-width:768px){.cf-field{padding:0;width:100%}.cf-field-left{padding:0}div#hs-eu-cookie-confirmation{bottom:0!important;top:auto!important;position:fixed!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p{width:100%;float:none}}.comeet-modal-open .comeet-modal{opacity:1}.comeet-intezer .entry-header{display:none}.comeet-intezer .comeet-outer-wrapper .comeet-groups-list .comeet-group-name,.comeet-intezer .comeet-outer-wrapper .comeet-groups-list .comeet-group-name a{margin-bottom:20px;width:100%;font-size:13px;font-weight:700;line-height:1.62;letter-spacing:.5px;color:#308aff;text-align:left}.comeet-position-name{font-family:"Museo500",sans-serif;font-size:17px;font-weight:500;line-height:1.35;letter-spacing:.57px;color:#233b52;padding:0 20px 0 20px;margin:0}.comeet-position-meta{font-size:11px;font-weight:700;font-stretch:normal;font-style:normal;line-height:1.5;letter-spacing:.44px;color:#627d98;min-height:46px;padding:20px 20px 6px 20px}.comeet-intezer a.comeet-position{display:block;border-bottom:0 solid #d5d5d5;padding-top:0;min-height:130px}.comeet-intezer .comeet-list li{background-color:#fff;width:31.5%;min-width:31.5%;border-radius:25px;border:solid 2px #ccd8e4;overflow:hidden;transition:all .3s;min-height:130px;margin-bottom:2.25%;margin-right:2.25%}.comeet-intezer .comeet-list li:hover{border:solid 2px #308aff}.comeet-intezer .comeet-list li:nth-child(3n){margin-right:0%}.comeet-intezer .comeet-list ul{display:flex;flex-direction:row;flex-wrap:wrap;align-content:flex-start;list-style:none;margin:0;padding:0}.comeet-single-job .entry-title,.comeet-single-job .all-jobs-link{display:none}.comeet-position-info{color:#627d98;font-size:13px;line-height:1.54;margin:14px 0}.comeet-single-job .comeet-position-info h4,.comeet-single-job .comeet-position-info h4,.comeet-single-job .comeet-apply h4{font-size:17px;font-family:"Museo500",sans-serif;color:#233b52;font-weight:500}.comeet-single-job ul{padding:0 0 0 25px;list-style-type:none;margin:20px 0}.comeet-single-job ul li{margin:14px 0}.comeet-single-job ul li:before{width:5px;overflow:hidden;margin-right:14px;color:#308aff;content:'-';position:relative;margin-left:-20px;font-weight:700;font-size:20px;line-height:17px}.comeet-single-job .comeet-outer-wrapper{padding:0 18%}.comeet-single-job .comeet-outer-wrapper .comeet-position-requirements ul{list-style:none}.comeet-single-job article{width:100%}@media (max-width:780px){.comeet-intezer .comeet-list li{width:100%;margin-bottom:4%;margin-right:0%}.comeet-single-job .comeet-outer-wrapper{padding:0 0%}.comeet-single-job article .container{width:100%;padding:0}}</style> <script src="https://intezer.com/wp-content/cache/ezcache/intezer.com/min/9f9b6055bfa86b7a2468c5291133c204.js" data-minify="1"></script> </head><body class="post-template-default single single-post postid-4736 single-format-standard wp-custom-logo executable-linkable-format-101-part-4-dynamic-linking"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KC95766"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="background-pop"></div><header id="header"><nav class="navbar navbar-toggleable-sm navbar-inverse bg-faded fixed-top" id="main-menu"> <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false"
aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button><div class="search-bar show-mobile"> <img src="https://intezer.com/wp-content/themes/intezer-v2/images/search-ico.png" alt=""></div><div class="show-mobile"><form role="search" method="get" class="search-form" action="https://intezer.com/"> <label> <span class="screen-reader-text">Search for:</span> <input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" /> </label> <input type="submit" class="search-submit" value="Search" /></form></div> <a class="navbar-brand" href="https://intezer.com/"> <a class="logo-link" href="https://intezer.com"><img class="logo-img" src="https://intezer.com/wp-content/uploads/2017/07/intezer-logo.png" alt="intezer"></a> </a><div class="collapse navbar-collapse" id="top-navbar"><ul id="menu-top-menu" class="navbar-nav ml-auto"><li id="menu-item-239" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-239 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Products" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Products </a><ul role="menu" class="dropdown-menu"><li id="menu-item-5071" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5071 nav-item"><a class="nav-link" title="Intezer Analyze" href="https://intezer.com/intezer-analyze/">Intezer Analyze</a></li><li id="menu-item-6685" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6685 nav-item"><a class="nav-link" title="Intezer Protect" href="https://intezer.com/intezer-protect/">Intezer Protect</a></li></ul></li><li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7240 nav-item"><a class="nav-link" title="Why Intezer" href="https://intezer.com/why-intezer/">Why Intezer</a></li><li id="menu-item-3097" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3097 nav-item"><a class="nav-link" title="Technology" href="https://intezer.com/technology/">Technology</a></li><li id="menu-item-131" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-131 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Company" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Company </a><ul role="menu" class="dropdown-menu"><li id="menu-item-70" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-70 nav-item"><a class="nav-link" title="About" href="https://intezer.com/about/">About</a></li><li id="menu-item-7095" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7095 nav-item"><a class="nav-link" title="Events" href="https://intezer.com/intezer-events/">Events</a></li><li id="menu-item-7096" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7096 nav-item"><a class="nav-link" title="News" href="https://intezer.com/intezer-news/">News</a></li><li id="menu-item-8417" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8417 nav-item"><a class="nav-link" title="Careers" href="https://intezer.com/careers/">Careers</a></li><li id="menu-item-114" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-114 nav-item"><a class="nav-link" title="Contact Us" href="https://intezer.com/contact-us/">Contact Us</a></li></ul></li><li id="menu-item-3061" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3061 nav-item"><a class="nav-link" title="Partners" href="https://intezer.com/partners/">Partners</a></li><li id="menu-item-125" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-125 nav-item"><a class="nav-link" title="Blog" href="https://intezer.com/blog/">Blog</a></li><li id="menu-item-1368" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1368 nav-item"><a class="nav-link" title="Resources" href="https://intezer.com/resources/">Resources</a></li><li id="menu-item-1028" class="try-now desktop-cta menu-item menu-item-type-custom menu-item-object-custom menu-item-1028 nav-item"><a class="nav-link" title="Get Started for Free" href="/get-started/"><span class="glyphicon Try it Now"></span>&nbsp;Get Started for Free</a></li><li id="menu-item-5106" class="try-now mobile-cta menu-item menu-item-type-custom menu-item-object-custom menu-item-5106 nav-item"><a class="nav-link" title="Get Started for Free" href="/get-started/"><span class="glyphicon Try our free Community Edition"></span>&nbsp;Get Started for Free</a></li></ul><div class="search-bar show-desktop"> <img src="https://intezer.com/wp-content/themes/intezer-v2/images/search-ico.png" alt=""></div><div class="show-desktop"><form role="search" method="get" class="search-form" action="https://intezer.com/"> <label> <span class="screen-reader-text">Search for:</span> <input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" /> </label> <input type="submit" class="search-submit" value="Search" /></form></div></div></nav></header><div class="popup"><div role="form" class="wpcf7" id="wpcf7-f468-o1" lang="en-US" dir="ltr"><div class="screen-reader-response"></div><form action="/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/#wpcf7-f468-o1" method="post" class="wpcf7-form clearfix" novalidate="novalidate" id="request-demo-form"><div style="display: none;"> <input type="hidden" name="_wpcf7" value="468" /> <input type="hidden" name="_wpcf7_version" value="5.1.7" /> <input type="hidden" name="_wpcf7_locale" value="en_US" /> <input type="hidden" name="_wpcf7_unit_tag" value="wpcf7-f468-o1" /> <input type="hidden" name="_wpcf7_container_post" value="0" /> <input type="hidden" name="_wpcf7cf_hidden_group_fields" value="" /> <input type="hidden" name="_wpcf7cf_hidden_groups" value="" /> <input type="hidden" name="_wpcf7cf_visible_groups" value="" /> <input type="hidden" name="_wpcf7cf_repeaters" value="[]" /> <input type="hidden" name="_wpcf7cf_steps" value="{}" /> <input type="hidden" name="_wpcf7cf_options" value="{&quot;form_id&quot;:468,&quot;conditions&quot;:[{&quot;then_field&quot;:&quot;group-570&quot;,&quot;and_rules&quot;:[{&quot;if_field&quot;:&quot;mx_Country&quot;,&quot;operator&quot;:&quot;equals&quot;,&quot;if_value&quot;:&quot;United States&quot;}]}],&quot;settings&quot;:{&quot;animation&quot;:&quot;yes&quot;,&quot;animation_intime&quot;:200,&quot;animation_outtime&quot;:200,&quot;notice_dismissed&quot;:false}}" /> <input type="hidden" name="g-recaptcha-response" value="" /></div><div class="form-header"></div><div class="cf-field cf-field-left"> <span class="cf-label">First Name</span><br /> <span class="wpcf7-form-control-wrap FirstName"><input type="text" name="FirstName" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required fname w-98" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field"> <span class="cf-label">Last Name</span><br /> <span class="wpcf7-form-control-wrap LastName"><input type="text" name="LastName" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required w-98" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field cf-field-left"> <span class="cf-label">Job Title</span><br /> <span class="wpcf7-form-control-wrap JobTitle"><input type="text" name="JobTitle" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required w-98" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field"> <span class="cf-label">Company</span><br /> <span class="wpcf7-form-control-wrap Company"><input type="text" name="Company" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required company" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field cf-field-left"> <span class="cf-label">Email</span><br /> <span class="wpcf7-form-control-wrap EmailAddress"><input type="email" name="EmailAddress" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-email wpcf7-validates-as-required wpcf7-validates-as-email email" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field"> <span class="cf-label">Country</span><br /> <span class="wpcf7-form-control-wrap mx_Country"><select name="mx_Country" class="wpcf7-form-control wpcf7-select wpcf7-validates-as-required country" aria-required="true" aria-invalid="false"><option value=""></option><option value="United States">United States</option><option value="Canada">Canada</option><option value="Afghanistan">Afghanistan</option><option value="Albania">Albania</option><option value="Algeria">Algeria</option><option value="Andorra">Andorra</option><option value="Angola">Angola</option><option value="Antigua and Barbuda">Antigua and Barbuda</option><option value="Argentina">Argentina</option><option value="Armenia">Armenia</option><option value="Aruba">Aruba</option><option value="Australia">Australia</option><option value="Austria">Austria</option><option value="Azerbaijan">Azerbaijan</option><option value="Bahamas">Bahamas</option><option value="Bahrain">Bahrain</option><option value="Bangladesh">Bangladesh</option><option value="Barbados">Barbados</option><option value="Belarus">Belarus</option><option value="Belgium">Belgium</option><option value="Belize">Belize</option><option value="Benin">Benin</option><option value="Bermuda">Bermuda</option><option value="Bhutan">Bhutan</option><option value="Bolivia">Bolivia</option><option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option><option value="Botswana">Botswana</option><option value="Brazil">Brazil</option><option value="Brunei">Brunei</option><option value="Bulgaria">Bulgaria</option><option value="Burkina Faso">Burkina Faso</option><option value="Burundi">Burundi</option><option value="Cambodia">Cambodia</option><option value="Cameroon">Cameroon</option><option value="Cape Verde">Cape Verde</option><option value="Cayman Islands">Cayman Islands</option><option value="Central African Republic">Central African Republic</option><option value="Chad">Chad</option><option value="Chile">Chile</option><option value="China">China</option><option value="Colombia">Colombia</option><option value="Comoros">Comoros</option><option value="Democratic Republic of the Congo (Kinshasa)">Democratic Republic of the Congo (Kinshasa)</option><option value="Congo, Republic of(Brazzaville)">Congo, Republic of(Brazzaville)</option><option value="Costa Rica">Costa Rica</option><option value="Croatia">Croatia</option><option value="Cuba">Cuba</option><option value="Cyprus">Cyprus</option><option value="Czech Republic">Czech Republic</option><option value="Denmark">Denmark</option><option value="Djibouti">Djibouti</option><option value="Dominica">Dominica</option><option value="Dominican Republic">Dominican Republic</option><option value="East Timor (Timor-Leste)">East Timor (Timor-Leste)</option><option value="Ecuador">Ecuador</option><option value="Egypt">Egypt</option><option value="El Salvador">El Salvador</option><option value="Equatorial Guinea">Equatorial Guinea</option><option value="Eritrea">Eritrea</option><option value="Estonia">Estonia</option><option value="Ethiopia">Ethiopia</option><option value="Fiji">Fiji</option><option value="Finland">Finland</option><option value="France">France</option><option value="Gabon">Gabon</option><option value="Gambia">Gambia</option><option value="Georgia">Georgia</option><option value="Germany">Germany</option><option value="Ghana">Ghana</option><option value="Gibraltar">Gibraltar</option><option value="Greece">Greece</option><option value="Grenada">Grenada</option><option value="Guatemala">Guatemala</option><option value="Guinea">Guinea</option><option value="Guinea-Bissau">Guinea-Bissau</option><option value="Guyana">Guyana</option><option value="Haiti">Haiti</option><option value="Honduras">Honduras</option><option value="Hong Kong">Hong Kong</option><option value="Hungary">Hungary</option><option value="Iceland">Iceland</option><option value="India">India</option><option value="Indonesia">Indonesia</option><option value="Iran, Islamic Republic of">Iran, Islamic Republic of</option><option value="Iraq">Iraq</option><option value="Ireland">Ireland</option><option value="Israel">Israel</option><option value="Italy">Italy</option><option value="Ivory Coast">Ivory Coast</option><option value="Jamaica">Jamaica</option><option value="Japan">Japan</option><option value="Jordan">Jordan</option><option value="Kazakhstan">Kazakhstan</option><option value="Kenya">Kenya</option><option value="Kiribati">Kiribati</option><option value="Korea, Democratic People&#039;s Republic of(North Korea)">Korea, Democratic People&#039;s Republic of(North Korea)</option><option value="Korea, Republic of">Korea, Republic of</option><option value="Kosovo">Kosovo</option><option value="Kuwait">Kuwait</option><option value="Kyrgyzstan">Kyrgyzstan</option><option value="Laos, People&#039;s Democratic Republic">Laos, People&#039;s Democratic Republic</option><option value="Latvia">Latvia</option><option value="Lebanon">Lebanon</option><option value="Lesotho">Lesotho</option><option value="Liberia">Liberia</option><option value="Libya">Libya</option><option value="Liechtenstein">Liechtenstein</option><option value="Lithuania">Lithuania</option><option value="Luxembourg">Luxembourg</option><option value="Macau">Macau</option><option value="Macedonia, Rep. of">Macedonia, Rep. of</option><option value="Madagascar">Madagascar</option><option value="Malawi">Malawi</option><option value="Malaysia">Malaysia</option><option value="Maldives">Maldives</option><option value="Mali">Mali</option><option value="Malta">Malta</option><option value="Marshall Islands">Marshall Islands</option><option value="Mauritania">Mauritania</option><option value="Mauritius">Mauritius</option><option value="Mexico">Mexico</option><option value="Micronesia, Federal States of">Micronesia, Federal States of</option><option value="Moldova, Republic of">Moldova, Republic of</option><option value="Monaco">Monaco</option><option value="Mongolia">Mongolia</option><option value="Montenegro">Montenegro</option><option value="Morocco">Morocco</option><option value="Mozambique">Mozambique</option><option value="Myanmar, Burma">Myanmar, Burma</option><option value="Namibia">Namibia</option><option value="Nauru">Nauru</option><option value="Nepal">Nepal</option><option value="Netherlands">Netherlands</option><option value="New Caledonia">New Caledonia</option><option value="New Zealand">New Zealand</option><option value="Nicaragua">Nicaragua</option><option value="Niger">Niger</option><option value="Nigeria">Nigeria</option><option value="Norway">Norway</option><option value="Oman">Oman</option><option value="Pakistan">Pakistan</option><option value="Palau">Palau</option><option value="Palestinian territories">Palestinian territories</option><option value="Panama">Panama</option><option value="Papua New Guinea">Papua New Guinea</option><option value="Paraguay">Paraguay</option><option value="Peru">Peru</option><option value="Philippines">Philippines</option><option value="Poland">Poland</option><option value="Portugal">Portugal</option><option value="Puerto Rico">Puerto Rico</option><option value="Qatar">Qatar</option><option value="Romania">Romania</option><option value="Russian Federation">Russian Federation</option><option value="Rwanda">Rwanda</option><option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option><option value="Saint Lucia">Saint Lucia</option><option value="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines</option><option value="Samoa">Samoa</option><option value="San Marino">San Marino</option><option value="Sao Tome and Principe">Sao Tome and Principe</option><option value="Saudi Arabia">Saudi Arabia</option><option value="Senegal">Senegal</option><option value="Serbia">Serbia</option><option value="Seychelles">Seychelles</option><option value="Sierra Leone">Sierra Leone</option><option value="Singapore">Singapore</option><option value="Slovakia (Slovak Republic)">Slovakia (Slovak Republic)</option><option value="Slovenia">Slovenia</option><option value="Solomon Islands">Solomon Islands</option><option value="Somalia">Somalia</option><option value="South Africa">South Africa</option><option value="South Sudan">South Sudan</option><option value="Spain">Spain</option><option value="Sri Lanka">Sri Lanka</option><option value="Sudan">Sudan</option><option value="Suriname">Suriname</option><option value="Swaziland">Swaziland</option><option value="Sweden">Sweden</option><option value="Switzerland">Switzerland</option><option value="Syria, Syrian Arab Republic">Syria, Syrian Arab Republic</option><option value="Taiwan">Taiwan</option><option value="Tajikistan">Tajikistan</option><option value="Tanzania; officially the United Republic of Tanzania">Tanzania; officially the United Republic of Tanzania</option><option value="Thailand">Thailand</option><option value="Tibet">Tibet</option><option value="Togo">Togo</option><option value="Tonga">Tonga</option><option value="Trinidad and Tobago">Trinidad and Tobago</option><option value="Tunisia">Tunisia</option><option value="Turkey">Turkey</option><option value="Turkmenistan">Turkmenistan</option><option value="Tuvalu">Tuvalu</option><option value="Uganda">Uganda</option><option value="Ukraine">Ukraine</option><option value="United Arab Emirates">United Arab Emirates</option><option value="United Kingdom">United Kingdom</option><option value="Uruguay">Uruguay</option><option value="Uzbekistan">Uzbekistan</option><option value="Vanuatu">Vanuatu</option><option value="Vatican City State (Holy See)">Vatican City State (Holy See)</option><option value="Venezuela">Venezuela</option><option value="Vietnam">Vietnam</option><option value="Yemen">Yemen</option><option value="Zambia">Zambia</option><option value="Zimbabwe">Zimbabwe</option></select></span></p><div data-id="group-570" data-orig_data_id="group-570" data-clear_on_hide data-class="wpcf7cf_group"> <span class="wpcf7-form-control-wrap mx_State"><select name="mx_State" class="wpcf7-form-control wpcf7-select country" aria-invalid="false"><option value="">Select State</option><option value="Alabama">Alabama</option><option value="Alaska">Alaska</option><option value="American Samoa">American Samoa</option><option value="Arizona">Arizona</option><option value="Arkansas">Arkansas</option><option value="California">California</option><option value="Colorado">Colorado</option><option value="Connecticut">Connecticut</option><option value="Delaware">Delaware</option><option value="District of Columbia">District of Columbia</option><option value="Florida">Florida</option><option value="Georgia">Georgia</option><option value="Guam">Guam</option><option value="Hawaii">Hawaii</option><option value="Idaho">Idaho</option><option value="Illinois">Illinois</option><option value="Indiana">Indiana</option><option value="Iowa">Iowa</option><option value="Kansas">Kansas</option><option value="Kentucky">Kentucky</option><option value="Louisiana">Louisiana</option><option value="Maine">Maine</option><option value="Maryland">Maryland</option><option value="Massachusetts">Massachusetts</option><option value="Michigan">Michigan</option><option value="Minnesota">Minnesota</option><option value="Mississippi">Mississippi</option><option value="Missouri">Missouri</option><option value="Montana">Montana</option><option value="Nebraska">Nebraska</option><option value="Nevada">Nevada</option><option value="New Hampshire">New Hampshire</option><option value="New Jersey">New Jersey</option><option value="New Mexico">New Mexico</option><option value="New York">New York</option><option value="North Carolina">North Carolina</option><option value="North Dakota">North Dakota</option><option value="Northern Mariana Islands">Northern Mariana Islands</option><option value="Ohio">Ohio</option><option value="Oklahoma">Oklahoma</option><option value="Oregon">Oregon</option><option value="Pennsylvania">Pennsylvania</option><option value="Puerto Rico">Puerto Rico</option><option value="Rhode Island">Rhode Island</option><option value="South Carolina">South Carolina</option><option value="South Dakota">South Dakota</option><option value="Tennessee">Tennessee</option><option value="Texas">Texas</option><option value="United States Minor Outlying Islands">United States Minor Outlying Islands</option><option value="Utah">Utah</option><option value="Vermont">Vermont</option><option value="Virgin Islands">Virgin Islands</option><option value="Virginia">Virginia</option><option value="Washington">Washington</option><option value="West Virginia">West Virginia</option><option value="Wisconsin">Wisconsin</option><option value="Wyoming">Wyoming</option></select></span></div></div> <input type="hidden" name="form-title" value="" class="wpcf7-form-control wpcf7-hidden form-title" /><p><input type="submit" value="Send Request" class="wpcf7-form-control wpcf7-submit btn btn-primary" /></p><div class="wpcf7-response-output wpcf7-display-none"></div></form></div></div><div id="primary" class="content-area"><div class="container"><div class="single-post-page"><h1 class="entry-title t-dianne">Executable and Linkable Format 101 Part 4: Dynamic Linking</h1><div class="row top-meta"><div class="col-md-12"><div class="author-box clearfix"><img src="https://intezer.com/wp-content/uploads/2020/01/Paul-60x60.png" class="user-photo"><div class="user-bio"><span class="author-light">Written by </span><span class="author-name"> Paul Litvak</span><span class="author-date"> - 25 June 2019</span></div></div></div><div class="main-blog-image"><img src="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253-1000x475.jpg" class="featured-img"></div></div><div class="row"><div class="col-md-2"><div class="side-blog-btn">Join our free community<a href="https://analyze.intezer.com" target="_blank" class="btn btn-prim dodger">Get started</a></div><div class="side-blog-share"">Share Article<div class="a2a_kit a2a_kit_size_ addtoany_list" data-a2a-url="https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/" data-a2a-title="Executable and Linkable Format 101 Part 4: Dynamic Linking"><a class="a2a_button_facebook" href="https://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-linkable-format-101-part-4-dynamic-linking%2F&amp;linkname=Executable%20and%20Linkable%20Format%20101%20Part%204%3A%20Dynamic%20Linking" title="Facebook" rel="nofollow noopener" target="_blank"><img src="/wp-content/themes/intezer-v2/images/social/facebook.png" alt="Facebook"></a><a class="a2a_button_twitter" href="https://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-linkable-format-101-part-4-dynamic-linking%2F&amp;linkname=Executable%20and%20Linkable%20Format%20101%20Part%204%3A%20Dynamic%20Linking" title="Twitter" rel="nofollow noopener" target="_blank"><img src="/wp-content/themes/intezer-v2/images/social/twitter.png" alt="Twitter"></a><a class="a2a_button_linkedin" href="https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-linkable-format-101-part-4-dynamic-linking%2F&amp;linkname=Executable%20and%20Linkable%20Format%20101%20Part%204%3A%20Dynamic%20Linking" title="LinkedIn" rel="nofollow noopener" target="_blank"><img src="/wp-content/themes/intezer-v2/images/social/linkedin.png" alt="LinkedIn"></a></div></div></div><div class="col-md-8"><div class="single-post-content"><p>This is a new post in our <strong>Executable and Linkable Format (ELF) 101 series</strong>, where the goal is to spread awareness about the format and the current Linux threat landscape.</p><ul><li><a href="http://intezer.com/executable-linkable-format-101-part1-sections-segments/" target="_blank" rel="noopener noreferrer">Part 1 (Sections and Segments)</a></li><li><a href="http://intezer.com/executable-linkable-format-101-part-2-symbols/" target="_blank" rel="noopener noreferrer">Part 2 (Symbols)</a></li><li><a href="http://intezer.com/executable-and-linkable-format-101-part-3-relocations/" target="_blank" rel="noopener noreferrer">Part 3 (Relocations)</a></li></ul><p>In this post, we will explore the <strong>dynamic linking process</strong>, including its purpose, how it works and the different linking modes. Apart from being a complex process, dynamic linking can also be abused by malware authors and therefore it is important for malware analysts to understand how the process works.</p><p>This post follows <a href="http://intezer.com/executable-and-linkable-format-101-part-3-relocations/" target="_blank" rel="noopener noreferrer">part three</a> of our ELF series, in which we discussed relocations and their relationship with symbols—useful for understanding dynamic linking.</p><p>&nbsp;</p><h3><strong>Linking Overview</strong></h3><p>In order to understand dynamic linking, we must first define linking. <strong>Linking</strong> is the process of joining together multiple object files, to create a shared library or an executable.</p><p><img class="alignnone wp-image-4734" src="http://intezer.com/wp-content/uploads/2019/06/untitled.png" alt="Linking" width="660" height="109" srcset="https://intezer.com/wp-content/uploads/2019/06/untitled.png 660w, https://intezer.com/wp-content/uploads/2019/06/untitled-300x50.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></p><p style="text-align: center; font-size: 14px;">Compilation of an object file</p><p>When one object file references functions or variables—which do not exist within the file’s context—but rather in other object files (dependencies), they must be linked. Linkers allow the use of separate, independent sources of code by providing a way to merge the code together into a single file, so the developer will be spared of this low-level detail.</p><p>For example:<br /> <img class="alignnone size-full wp-image-4763" src="http://intezer.com/wp-content/uploads/2019/06/code.png" alt="" srcset="https://intezer.com/wp-content/uploads/2019/06/code.png 675w, https://intezer.com/wp-content/uploads/2019/06/code-300x62.png 300w" sizes="(max-width: 675px) 100vw, 675px" /><br /> <em>main.c</em> does not implement the <em>printf </em>function, so in order to invoke <em>printf</em>, <em>main.o</em> will have to be linked against <em>printf.o</em> (the <em>include &lt;stdio.h&gt;</em> directive only imports the definition of <em>printf</em>—it does not contain its implementation).</p><p>There are two linking types:</p><ul><li><strong>Static linking:</strong> Completed at the end of the compilation process</li><li><strong>Dynamic linking:</strong> Completed at load time by the system</li></ul><p><strong>Static linking</strong> is fairly simple:</p><p><img class="alignnone wp-image-4729" src="http://intezer.com/wp-content/uploads/2019/06/static_linking322.png" alt="Static linking " width="441" height="257" srcset="https://intezer.com/wp-content/uploads/2019/06/static_linking322.png 441w, https://intezer.com/wp-content/uploads/2019/06/static_linking322-300x175.png 300w" sizes="(max-width: 441px) 100vw, 441px" /></p><p>The compile-time linker (<strong><i>l</i></strong><em><strong>d</strong></em>) collects all relevant object files—<em>main.o</em> and the <em>libc.a</em> static library (a bundle of object-files)—applies relocations and combines the files into a single binary. As such, when many object files are linked, the resulting binary file size can become very large.</p><p><strong>Dynamic linking</strong>, on the other hand, is a more complex process. Unlike in static linking, <strong><i>l</i></strong><em><strong>d</strong></em> requires shared libraries to create a dynamically linked executable. The output file will contain the executable’s code and the names of the shared libraries required, embedded within the binary:</p><p><img class="alignnone wp-image-4733" src="http://intezer.com/wp-content/uploads/2019/06/dynamic_linking211.png" alt="Dynamic linking" width="506" height="257" srcset="https://intezer.com/wp-content/uploads/2019/06/dynamic_linking211.png 506w, https://intezer.com/wp-content/uploads/2019/06/dynamic_linking211-300x152.png 300w" sizes="(max-width: 506px) 100vw, 506px" /></p><p>When the binary is executed, the dynamic linker will find the required dependencies to load and link them together. Thereby, deferring the linking stage from compile-time to run-time. We will detail how this process works shortly.</p><p>There are pros and cons to these two approaches:</p><ul><li><strong>Static linking</strong> allows containing all dependencies in a single binary, making it more portable and simple to execute, at the expense of the file size.</li><li><strong>Dynamic linking</strong> allows the binary to be smaller, at the expense of having to ensure that the required dependencies exist in the target system that the binary will be executed in.</li></ul><p>&nbsp;</p><h3><strong>The Dynamic Linking Process</strong></h3><p>The dynamic linking process begins immediately after execution.</p><p>For statically linked programs, execution is straight forward. The system creates the memory layout from the file’s segments and passes control to the file’s entry point.</p><p>With dynamically linked programs, the system executes the file’s “interpreter”, which is an intermediate program that should set up the environment and only then execute the main binary. The interpreter lies in the <em>PT_INTERP</em> segment created by the compile-time linker (<em><strong>ld</strong></em>). In this case, the interpreter is the dynamic linker program <strong>ld-linux.so.2</strong>:</p><p><img class="alignnone wp-image-4725" src="http://intezer.com/wp-content/uploads/2019/06/pasted-image-0-2.png" alt="dynamic linker program" width="616" height="76" srcset="https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-2.png 592w, https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-2-300x37.png 300w" sizes="(max-width: 616px) 100vw, 616px" /></p><p style="text-align: center; font-size: 14px;">The <em>.interp</em> section is mapped in the same address as the PT_INTERP segment</p><p>The dynamic linker will set up the environment using dynamic entries from the <em>.dynamic</em> section:</p><p><img class="alignnone wp-image-4727" src="http://intezer.com/wp-content/uploads/2019/06/pasted-image-0-4.png" alt="The dynamic linker" width="615" height="537" srcset="https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-4.png 615w, https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-4-300x262.png 300w" sizes="(max-width: 615px) 100vw, 615px" /></p><p>These entries are crucial to the dynamic linker, which include:</p><ul><li><strong>DT_NEEDED</strong> &#8211; the name of a required dependency to load.</li><li><strong>DT_SYMTAB</strong> &#8211; the address of the dynamic symbol table (covered in our <a href="http://intezer.com/executable-linkable-format-101-part-2-symbols/" target="_blank" rel="noopener noreferrer">previous blog post</a> about symbols).</li><li><strong>DT_FLAGS</strong> &#8211; such as the BIND_NOW flag that instructs the dynamic linker to perform all linking before handing over control to the program.</li></ul><p>When the binary is executed, the system loads the dynamic linker into memory and execution will be passed to the dynamic linker’s entry point. The dynamic linker begins preparing the environment as follows:</p><p><img class="wp-image-4731" src="http://intezer.com/wp-content/uploads/2019/06/dynamicLinking22.png" alt="dynamicLinking22" srcset="https://intezer.com/wp-content/uploads/2019/06/dynamicLinking22.png 736w, https://intezer.com/wp-content/uploads/2019/06/dynamicLinking22-300x237.png 300w" sizes="(max-width: 736px) 100vw, 736px" /></p><p style="text-align: center; font-size: 14px;">Memory view during dynamic linking</p><ol style="color: #505157; line-height: 30px; font-weight: 300; font-size: 19px;"><li>Load the original file’s PT_LOAD segments in memory.</li><li>Use the <em>.dynamic</em> section/segment to read dependencies, search for them on disk and load them in memory as well. This is done recursively for dependent libraries—they can be dynamically linked as well. The dependency searching algorithm is outlined in the <a href="http://man7.org/linux/man-pages/man8/ld.so.8.html" target="_blank" rel="noopener noreferrer">ld.so man page</a>.</li><li>Perform relocations &#8211; shared libraries are loaded into non-deterministic addresses and must have absolute addresses patched, as well as resolving references to other object files.</li><li>Invoke shared library initialization functions (registered in the <em>.preinit_array, .init, .init_array</em> sections).</li><li>Finally, pass control back to the original binary’s entry point, making it seem to the binary that control was passed directly from <em>exec</em>.</li></ol><p>It is important to mention the <strong>LD_PRELOAD</strong> feature, which enables defined libraries to precede the loading of other dependencies. This is useful for overriding functions in other linked modules. This feature can be configured via the <em>LD_PRELOAD</em> environment variable, or via the <em>/etc/ld.so.preload</em> file.</p><p>This feature is often abused by malware developers to hook known functions. Our recent <a href="http://intezer.com/blog-hiddenwasp-malware-targeting-linux-systems/" target="_blank" rel="noopener noreferrer">HiddenWasp Linux-based malware</a> discovery demonstrates such use:</p><p><img class="wp-image-4728" src="http://intezer.com/wp-content/uploads/2019/06/pasted-image-0-5.png" alt="pasted image 0 5" srcset="https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-5.png 370w, https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-5-300x15.png 300w" sizes="(max-width: 370px) 100vw, 370px" /></p><p><img class="wp-image-4726" src="http://intezer.com/wp-content/uploads/2019/06/pasted-image-0-3.png" alt="pasted image 0 3" srcset="https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-3.png 375w, https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-3-300x66.png 300w" sizes="(max-width: 375px) 100vw, 375px" /></p><p><img class="wp-image-4723" src="http://intezer.com/wp-content/uploads/2019/06/pasted-image-0.png" alt="pasted image 0" /></p><p style="text-align: center; font-size: 14px;">Hooked libc functions by malicious preloaded <em>libse1linux.so</em></p><p>Another interesting feature is <strong>LD_LIBRARY_PATH</strong>. This environment variable holds the path to the first directory where dependencies will be searched for, and is therefore abused by some malware developers as well.</p><p>Additional environment variables and configuration files that can alter the dynamic linker’s behavior do exist, and will be covered in the future dedicatedly.</p><p>&nbsp;</p><h3><strong>Lazy Linking</strong></h3><p>We mentioned earlier that the dynamic linker performs all relocations before handing over control to the main binary, however, this is not always the case.</p><p>Let’s examine the following code example which will be dynamically compiled:</p><p><img class="alignnone size-full wp-image-4764" src="http://intezer.com/wp-content/uploads/2019/06/code2.png" alt="" srcset="https://intezer.com/wp-content/uploads/2019/06/code2.png 677w, https://intezer.com/wp-content/uploads/2019/06/code2-300x82.png 300w" sizes="(max-width: 677px) 100vw, 677px" /></p><p>The program checks for the correct input in its command line <em>“s3cr3t_password”</em>.<br /> If the input matches, the program will begin executing its main logic. If not, the program will immediately terminate.</p><p>If the program receives an incorrect input, it will terminate, rendering useless all of the relocation work performed by the dynamic linker. One can imagine how many relocations would be applied on a codebase with thousands of symbols. Precious time would be wasted by enforcing each and every symbol relocation.</p><p><strong>Lazy linking</strong> is an optimization for this problem. Lazy linking instructs the dynamic linker to resolve function references when they are called (lazily) instead of at load-time (eagerly).</p><p>This is enabled by the <strong>Procedure Linkage Table (PLT)</strong> and the <strong>Global Offset Table (GOT)</strong>.</p><p>The GOT holds entries of addresses of global variables and external functions.</p><p>The PLT consists of short entries of instructions (often called “trampolines” or “thunks”), used to reach external functions by redirecting control flow of execution to its corresponding GOT entry.</p><p>Generally speaking, in dynamically linked executables, external functions are reached by calling their respective PLT entry:</p><p><img class="wp-image-4732" src="http://intezer.com/wp-content/uploads/2019/06/pasted-image-0-6.png" alt="pasted image 0 6" srcset="https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-6.png 702w, https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-6-300x24.png 300w" sizes="(max-width: 702px) 100vw, 702px" /></p><p>The PLT entry will retrieve the function’s address from the function’s GOT entry, and call it:</p><p><img class="wp-image-4724" src="http://intezer.com/wp-content/uploads/2019/06/pasted-image-0-1.png" alt="pasted image 0 1" srcset="https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-1.png 431w, https://intezer.com/wp-content/uploads/2019/06/pasted-image-0-1-300x20.png 300w" sizes="(max-width: 431px) 100vw, 431px" /></p><ul><li>With early binding, GOT entries are relocated by the dynamic linker at load-time.</li><li>With lazy linking, the GOT entries will be relocated on-demand by a function call. At a function’s first invocation, the PLT will be used to call the dynamic linker to link the missing function.</li></ul><p>We will compile the last example with lazy linking this time.</p><p><img class="alignnone size-full wp-image-4744" src="http://intezer.com/wp-content/uploads/2019/06/Screen-Shot-2019-06-24-at-4.17.34-PM.png" alt="" srcset="https://intezer.com/wp-content/uploads/2019/06/Screen-Shot-2019-06-24-at-4.17.34-PM.png 686w, https://intezer.com/wp-content/uploads/2019/06/Screen-Shot-2019-06-24-at-4.17.34-PM-300x17.png 300w" sizes="(max-width: 686px) 100vw, 686px" /></p><p>Now, we can see what happens when a function is called for the first time:</p><p><img class="wp-image-4730" src="http://intezer.com/wp-content/uploads/2019/06/trampoline7.png" alt="trampoline7" srcset="https://intezer.com/wp-content/uploads/2019/06/trampoline7.png 910w, https://intezer.com/wp-content/uploads/2019/06/trampoline7-300x164.png 300w, https://intezer.com/wp-content/uploads/2019/06/trampoline7-768x419.png 768w, https://intezer.com/wp-content/uploads/2019/06/trampoline7-253x139.png 253w" sizes="(max-width: 910px) 100vw, 910px" /></p><ol style="color: #505157; line-height: 30px; font-weight: 300; font-size: 19px;"><li>The <em>printf </em>PLT entry is called, the GOT entry is retrieved and jumped to.</li><li>At load-time, the dynamic linker fills every GOT entry with the address pointing to the second instruction of the respective PLT entry. Therefore, <em>printf</em>’s GOT entry will point back to <em>printf@plt+0x6</em>. The dynamic linker needs to know which function needs to be relocated, so we push a number to the stack (I.E. 0): An index, which serves as the index of the relocation in the <em>.rel.plt</em> section, is used to calculate the requested entry in the GOT (GOT[index+3]—the first three indexes are reserved to addresses related to the dynamic linker as seen in the illustration).</li><li>The first PLT entry (PLT[0]) is called, whose purpose is to call the dynamic linker’s _dl_runtime_resolve to resolve the designated relocation.</li><li>Consequently, control will be passed to the dynamic linker. The dynamic linker will relocate the <em>printf</em> GOT entry to point to the correct address within <em>libc.so</em>, and finally pass control to <em>printf</em>.</li></ol><p>A resolved GOT entry:</p><p><img class="wp-image-4735" src="http://intezer.com/wp-content/uploads/2019/06/Untitled-Diagram.png" alt="Untitled Diagram" srcset="https://intezer.com/wp-content/uploads/2019/06/Untitled-Diagram.png 494w, https://intezer.com/wp-content/uploads/2019/06/Untitled-Diagram-300x265.png 300w" sizes="(max-width: 494px) 100vw, 494px" /></p><p>Future calls to <em>printf@plt</em> will retrieve <em>printf</em>’s resolved address residing in the GOT and jump there immediately.</p><p>&nbsp;</p><h3><strong>Summary</strong></h3><p>This post explained the differences between static and dynamic linking. Furthermore, the information presented the dynamic linking process, and its lazy linking feature.</p><p>It is interesting to see malware in the wild abusing dynamic linker features as it does require some degree of knowledge and sophistication.</p><p>We hope you enjoyed reading this post and stay tuned for more to come. If you have any questions, please feel free to contact us.</p><p>Here are some additional resources for further reading:</p><ul><li>How ELF loads: <a href="https://lwn.net/Articles/631631/" target="_blank" rel="noopener nofollow noreferrer">https://lwn.net/Articles/631631/</a></li><li>ld.so man page: <a href="http://man7.org/linux/man-pages/man8/ld.so.8.html" target="_blank" rel="noopener nofollow noreferrer">http://man7.org/linux/man-pages/man8/ld.so.8.html</a></li><li><a href="https://codywu2010.wordpress.com/2014/11/29/about-elf-pie-pic-and-else/" target="_blank" rel="noopener nofollow noreferrer">https://codywu2010.wordpress.com/2014/11/29/about-elf-pie-pic-and-else/</a></li><li><a href="https://medium.com/@HockeyInJune/relro-relocation-read-only-c8d0933faef3" target="_blank" rel="noopener nofollow noreferrer">https://medium.com/@HockeyInJune/relro-relocation-read-only-c8d0933faef3</a></li></ul></div><div class="author-box-bottom clearfix"><img src="https://intezer.com/wp-content/uploads/2020/01/Paul-60x60.png" class="user-photo"><div class="user-bio"><strong> Paul Litvak</strong><div class="share-author"><a href="https://twitter.com/polarply" target="_blank" class="twitter-link"><i class="fa fa-twitter" aria-hidden="true"></i></a><a href="https://il.linkedin.com/in/paul-litvak-7b35a7133" target="_blank" class="linkedin-link"><i class="fa fa-linkedin" aria-hidden="true"></i></a></div><p>Paul is a malware analyst and reverse engineer at Intezer. He previously served as a developer in the Israel Defense Force (IDF) Intelligence Corps for three years</p></div></div><div class="post-tags"> <a href="https://intezer.com/tag/elf/" rel="tag">ELF</a> <a href="https://intezer.com/tag/linux/" rel="tag">Linux</a> <a href="https://intezer.com/tag/research/" rel="tag">Research</a></div></div><div class="col-md-2"></div></div></div></div><div class="container narrow"><nav class="post-nav clearfix"><div class="prev-post"> <a href="https://intezer.com/blog/use-cases/genetic-malware-analysis-use-cases-government-agencies/" rel="prev"></a><div class="post-link clear"><h4><a href="https://intezer.com/blog/use-cases/genetic-malware-analysis-use-cases-government-agencies/" rel="prev">Genetic Malware Analysis Use Cases: Government Agencies</a></h4></div></div><div class="next-post"> <a href="https://intezer.com/blog/linux/hiddenwasp-emergence-of-linux-threats/" rel="next"></a><div class="post-link clear"><h4><a href="https://intezer.com/blog/linux/hiddenwasp-emergence-of-linux-threats/" rel="next">HiddenWasp and the Emergence of Linux-based Threats</a></h4></div></div></nav><div class="related-posts"><h3>Recomended Articles</h3><ul class="row related-cont"><li class="related-single"> <span class="thumb"> <a href="https://intezer.com/blog/linux/linux-rekoobe-operating-with-new-undetected-malware-samples/" title=""><img src="https://intezer.com/wp-content/uploads/2020/01/shutterstock_724157941-253x139.jpg" alt="Linux Rekoobe Operating with New, Undetected Malware Samples" class="post-thumb" /></a> </span> <span class="read-time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 6</span> <span class="rt-label rt-postfix"></span></span></span><h4> <a href="https://intezer.com/blog/linux/linux-rekoobe-operating-with-new-undetected-malware-samples/">Linux Rekoobe Operating with New, Undetected Malware Samples</a></h4> <span class="post-excerpt">Introduction Our research team has identified new versions of an old Linux malware known...</span> <span class="post-date">20 January 2020</span></li><li class="related-single"> <span class="thumb"> <a href="https://intezer.com/blog/intezer-analyze-community/intezer-analyze-community-2019-recap-and-trends/" title=""><img src="https://intezer.com/wp-content/uploads/2020/01/Blog-Cover-Photo-1-253x139.png" alt="Intezer Analyze Community: 2019 Recap and Trends" class="post-thumb" /></a> </span> <span class="read-time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 4</span> <span class="rt-label rt-postfix"></span></span></span><h4> <a href="https://intezer.com/blog/intezer-analyze-community/intezer-analyze-community-2019-recap-and-trends/">Intezer Analyze Community: 2019 Recap and Trends</a></h4> <span class="post-excerpt">Emotet, Trickbot, and Lazarus were the most common threats detected by the community in...</span> <span class="post-date">6 January 2020</span></li><li class="related-single"> <span class="thumb"> <a href="https://intezer.com/blog/genetic-malware-analysis/2019-a-year-in-review/" title=""><img src="https://intezer.com/wp-content/uploads/2020/01/Blog-Cover-Photo-2-253x139.png" alt="2019: A Year-in-Review" class="post-thumb" /></a> </span> <span class="read-time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 3</span> <span class="rt-label rt-postfix"></span></span></span><h4> <a href="https://intezer.com/blog/genetic-malware-analysis/2019-a-year-in-review/">2019: A Year-in-Review</a></h4> <span class="post-excerpt">What an amazing year it has been for us at Intezer! The company nearly...</span> <span class="post-date">19 December 2019</span></li></ul></div></div></div> <script>$(function(){$('div.single-post-page').find('a').addClass('blog-text-link')});$(document).ready(function(){var blogbtn=$('div.side-blog-btn').offset();var $window=$(window);$window.scroll(function(){if($window.scrollTop()>=blogbtn.top-100){$("div.side-blog-btn").addClass("fixed");$("div.side-blog-share").addClass("fixed")}else if($window.scrollTop()<blogbtn.top-100){$("div.side-blog-btn").removeClass("fixed");$("div.side-blog-share").removeClass("fixed")}})})</script> <footer><div class="container"><div class="row"><div class="footer-logo-cont"><img src="https://intezer.com/wp-content/themes/intezer-v2/images/intezer-logo-b.png" alt="intezer footer logo" title="" class="footer-logo"></div><div class="footer-left"><ul id="menu-footer-1" class="footer-1"><li id="menu-item-247" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-247 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Products" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Products </a><ul role="menu" class="dropdown-menu"><li id="menu-item-1453" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1453 nav-item"><a class="nav-link" title="Intezer Analyze" href="https://intezer.com/intezer-analyze/">Intezer Analyze</a></li><li id="menu-item-7166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7166 nav-item"><a class="nav-link" title="Intezer Protect" href="https://intezer.com/intezer-protect/">Intezer Protect</a></li></ul></li><li id="menu-item-7244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7244 nav-item"><a class="nav-link" title="Why Intezer" href="https://intezer.com/why-intezer/">Why Intezer</a></li><li id="menu-item-3098" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3098 nav-item"><a class="nav-link" title="Technology" href="https://intezer.com/technology/">Technology</a></li><li id="menu-item-213" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-213 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Company" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Company </a><ul role="menu" class="dropdown-menu"><li id="menu-item-215" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-215 nav-item"><a class="nav-link" title="About" href="https://intezer.com/about/">About</a></li><li id="menu-item-7167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7167 nav-item"><a class="nav-link" title="Events" href="https://intezer.com/intezer-events/">Events</a></li><li id="menu-item-7168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7168 nav-item"><a class="nav-link" title="News" href="https://intezer.com/intezer-news/">News</a></li><li id="menu-item-8418" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8418 nav-item"><a class="nav-link" title="Careers" href="https://intezer.com/careers/">Careers</a></li><li id="menu-item-216" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-216 nav-item"><a class="nav-link" title="Contact us" href="https://intezer.com/contact-us/">Contact us</a></li></ul></li><li id="menu-item-7169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7169 nav-item"><a class="nav-link" title="Partners" href="https://intezer.com/partners/">Partners</a></li><li id="menu-item-217" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-217 nav-item"><a class="nav-link" title="Blog" href="https://intezer.com/blog/">Blog</a></li><li id="menu-item-2061" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2061 nav-item"><a class="nav-link" title="Resources" href="https://intezer.com/resources/">Resources</a></li></ul></div></div></div></footer><div id="credit"><div class="container"><div> © Intezer.com 2020 All rights reserved<ul id="menu-footer-2" class="footer-2"><li id="menu-item-59" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-59"><a href="https://intezer.com/terms-of-use/">Terms of Use</a></li><li id="menu-item-222" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-222"><a href="https://intezer.com/privacy/">Privacy Policy</a></li></ul><div class="social footer-right"><ul><li><a href="https://www.facebook.com/IntezerLabs/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a href="https://www.linkedin.com/company/intezer-labs" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a href="https://twitter.com/intezerlabs" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a href="https://www.youtube.com/channel/UCt5L5ztHh-C1NCKa6bKjXFQ?view_as=subscriber" target="_blank"><i class="fa fa-youtube" aria-hidden="true"></i></a></li></ul></div></div></div></div>  <script type="text/javascript">$(window).scroll(function(){var nav=$('#main-menu');var top=150;if($(window).scrollTop()>=top){nav.addClass('botborder')}else{nav.removeClass('botborder')}})</script> <script type='text/javascript'>/* <![CDATA[ */ var wpcf7={"apiSettings":{"root":"https:\/\/intezer.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"} /* ]]> */</script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.1.7'></script> <script type='text/javascript' src='https://www.google.com/recaptcha/api.js?render=6LewXc8UAAAAADEYz8dYpHTk55uH2MjKqbyc1sXD&#038;ver=3.0'></script> <script type='text/javascript' src='https://intezer.com/wp-content/themes/intezer-v2/js/tether.min.js?ver=5.3.2'></script> <script type='text/javascript' src='https://intezer.com/wp-content/themes/intezer-v2/js/bootstrap.min.js?ver=5.3.2'></script> <script type='text/javascript' src='https://intezer.com/wp-content/themes/intezer-v2/js/main.js?ver=5.3.2'></script> <script type='text/javascript'>/* <![CDATA[ */ var wpcf7cf_global_settings={"ajaxurl":"https:\/\/intezer.com\/wp-admin\/admin-ajax.php"} /* ]]> */</script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/cf7-conditional-fields/js/scripts.js?ver=1.8.3'></script> <script type="text/javascript" id="slb_context">/* <![CDATA[ */ if(!!window.jQuery){(function($){$(document).ready(function(){if(!!window.SLB){{$.extend(SLB,{"context":["public","user_guest"]})}}})})(jQuery)} /* ]]> */</script> <script type="text/javascript">(function(grecaptcha,sitekey,actions){var wpcf7recaptcha={execute:function(action){grecaptcha.execute(sitekey,{action:action}).then(function(token){var forms=document.getElementsByTagName('form');for(var i=0;i<forms.length;i++){var fields=forms[i].getElementsByTagName('input');for(var j=0;j<fields.length;j++){var field=fields[j];if('g-recaptcha-response'===field.getAttribute('name')){field.setAttribute('value',token);break}}}})},executeOnHomepage:function(){wpcf7recaptcha.execute(actions.homepage)},executeOnContactform:function(){wpcf7recaptcha.execute(actions.contactform)},};grecaptcha.ready(wpcf7recaptcha.executeOnHomepage);document.addEventListener('change',wpcf7recaptcha.executeOnContactform,!1);document.addEventListener('wpcf7submit',wpcf7recaptcha.executeOnHomepage,!1)})(grecaptcha,'6LewXc8UAAAAADEYz8dYpHTk55uH2MjKqbyc1sXD',{"homepage":"homepage","contactform":"contactform"})</script>  <script type="text/javascript">/* <![CDATA[ */ var google_conversion_id=842858921;var google_custom_params=window.google_tag_params;var google_remarketing_only=!0 /* ]]> */</script> <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script> <noscript><div style="display:inline;"> <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/842858921/?guid=ON&amp;script=0"/></div> </noscript>  <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5492986.js"></script> </body></html>
<!-- Cached by ezCache -->
<!-- Cache created in 0.56s -->