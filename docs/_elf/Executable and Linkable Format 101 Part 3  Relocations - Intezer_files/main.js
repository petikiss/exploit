$('.slb_details').insertBefore($('.slb_content'));
$('.slb_controls').insertBefore($('.slb_details'));
$(function(){
    $('.slideshow img:gt(0)').hide();
    setInterval(function(){
      $('.slideshow :first-child').fadeOut(800)
         .next('img').fadeIn(800)
         .end().appendTo('.slideshow');}, 
      3000);
});


$(function(){
    $('.slideshow-2 img:gt(0)').hide();
    setInterval(function(){
      $('.slideshow-2 :first-child').fadeOut(800)
         .next('img').fadeIn(800)
         .end().appendTo('.slideshow-2');}, 
      3000);
});

// Add class to empty TR in plans table
$("table tr").each(function() {        
    var cell = $.trim($(this).find('td').text());
    if (cell.length == 0){
        // console.log('empty');
        $(this).addClass('empty-tr');
    }                   
});

(function ($) {

  if ($('#assess_contact_btn').length > 0) {
    $('#assess_contact_btn').on('click', function() {
      $(this).parent().fadeOut(function() {$('.contact-form-wrapper').fadeIn()});
    })
  }

  // Check if owl exist to not trigger jQuery conflicts
  if ($('.owl-carousel .item').length > 1) {
      $('.owl-carousel').owlCarousel({
          nav: false,
          loop: true,
          items: 1,
          dots: true,
          autoplay: true,
          autoplayTimeout: 6000,
          slideSpeed: 1000,
          touchDrag  : true,
          mouseDrag  : false,
          autoHeight : false,
		  animateOut: 'fadeOut',
          //navContainerClass: "arrow-controls",
          // responsive: {
          //     0: {
          //         items: 1
          //     },
          //     480: {
          //         items: 1
          //     },
          //     600: {
          //         items: 1
          //     },
          //     700: {
          //         items: 1
          //     },
          //     1300: {
          //         items: 1
          //     }
          // }
      });
  }
    // Popup
	$('.request-pricing-btn').on('click', function () {
        $('.popup').fadeIn(300);
        $('.background-pop').fadeIn(300);
		$('.form-title').val('Request Analayze Pricing');
	    $('.form-header').removeClass('protect');
		$('.form-header').addClass('pricing');
		$('.form-header').removeClass('protect-trial');
		$('.wpcf7-submit').removeClass('protect');
		$('.wpcf7-submit').addClass('analyze');
        $('#request-demo-form').removeClass('protect');
        $('#request-demo-form').addClass('analyze');
    });

	$('.request-demo-analyze-btn').on('click', function () {
        $('.popup').fadeIn(300);
        $('.background-pop').fadeIn(300);
		$('.form-title').val('Analyze Demo');
		$('.form-header').addClass('analyze');
		$('.form-header').removeClass('protect-trial');
		$('.form-header').removeClass('protect');
        $('.form-header').removeClass('pricing');
        $('.wpcf7-submit').addClass('analyze');
		$('.wpcf7-submit').removeClass('protect');
        $('#request-demo-form').removeClass('protect');
        $('#request-demo-form').addClass('analyze');
    });
	$('.request-demo-ptotect-btn').on('click', function () {
        $('.popup').fadeIn(300);
        $('.background-pop').fadeIn(300);
		$('.form-title').val('Protect Demo');
		$('.form-header').addClass('protect');
		$('.form-header').removeClass('protect-trial');
		$('.form-header').removeClass('analyze');
		$('.form-header').removeClass('pricing');
        $('.wpcf7-submit').addClass('protect');
		$('.wpcf7-submit').removeClass('analyze');
        $('#request-demo-form').removeClass('analyze');
        $('#request-demo-form').addClass('protect'); 

    });
	$('.request-trial-ptotect-btn').on('click', function () {
        $('.popup').fadeIn(300);
        $('.background-pop').fadeIn(300);
		$('.form-title').val('Protect Trial');
		$('.form-header').addClass('protect-trial');
		$('.form-header').removeClass('protect');
		$('.form-header').removeClass('analyze');
		$('.form-header').removeClass('pricing');
        $('.wpcf7-submit').addClass('protect');
		$('.wpcf7-submit').removeClass('analyze');
        $('#request-demo-form').removeClass('analyze');
        $('#request-demo-form').addClass('protect'); 
    });
    	$('.request-pricing-ptotect-btn').on('click', function () {
        $('.popup').fadeIn(300);
        $('.background-pop').fadeIn(300);
		$('.form-title').val('Protect Pricing');
		$('.form-header').addClass('protect-trial');
		$('.form-header').removeClass('protect');
		$('.form-header').removeClass('analyze');
		$('.form-header').addClass('pricing');
		$('.wpcf7-submit').addClass('protect');
		$('.wpcf7-submit').removeClass('analyze');
        $('#request-demo-form').removeClass('analyze');
        $('#request-demo-form').addClass('protect'); 
    });
    $('#pop-video').on('click', function () {
        $('.popup-video').fadeIn(300);
        $('.background-pop').fadeIn(300);
    });

    $('.pop-whitepaper').on('click', function () {
      if($(this).data("id") != ""){
        console.log('yes form');
        var id = $(this).data("id");
        var title = $(this).data("title");
        var text = $(this).data("text");
        var url = $(this).data("url");

        $('#'+ id + ' #whitepaper-form').attr('data-download', url);
        $('#'+ id + ' #whitepaper-form').attr('data-title', title);
        $('#'+ id + ' #downloadedFileType').attr('value', title);
        $( '#'+ id + ' #resource-title' ).html( title );
        $( '#'+ id + ' #resource-text' ).html( text );
        $( '#'+ id + ' #download-btn' ).attr("href", url);
        $( '#'+ id + ' #download-btn' ).hide();
        $('#'+ id).fadeIn(300);
        $('.background-pop').fadeIn(300);
      }else{
        console.log('no form');
        $('.global-form').fadeIn(300);
        $('.background-pop').fadeIn(300);
      }
    });

    $('.background-pop').on('click', function () {
        $(this).fadeOut(300);
        $('.popup-video').fadeOut(300);
        $('.popup-resources').fadeOut(300);
        $('.popup').fadeOut(300);
    });
    $('.close-btn').on('click', function () {
        $('.popup-resources').fadeOut(300);
        $('.background-pop').fadeOut(300);
    });
    // ESCAPE key pressed
    window.onkeydown = function( event ) {
        if ( event.keyCode == 27 ) {
            $('.popup-video').fadeOut(300);
        }
    };

    document.addEventListener( 'wpcf7mailsent', function( event ) {
      $('#partners-3 h2').addClass('email-sent');
      $('#partners-3 h2').text('Message Sent Successfully');
      $('#contact-us h2').addClass('email-sent');
      $('#contact-us h2').text('Message Sent Successfully');
    }, false );

    // Slideshow
    // var count = 1;
    // setInterval(function() {
    //     count = ($(".slideshow :nth-child("+count+")").fadeOut(800).next().length == 0) ? 1 : count+1;
    //     $(".slideshow :nth-child("+count+")").fadeIn(800);
    // }, 3000);


    if ($(window).width() <= 768) {
          $('.menu-item-has-children > a.dropdown-toggle').on('click', function (e) {
              e.preventDefault();
              $(this).toggleClass('open');
              $(this).parent().find('ul').slideToggle('300');
          }); 

    } else {
      $('ul.navbar-nav li.dropdown').hover(function () {
        $(this).find('.dropdown-menu').stop(true, true).fadeIn(300)
      }, function () {
        $(this).find('.dropdown-menu').stop(true, true).fadeOut(300)
      })
    }

  $(window).scroll(function () {
    if ($(this).scrollTop() >= 500) {
      $('#return-to-top').fadeIn(200)
    } else {
      $('#return-to-top').fadeOut(200)
    }
  })
  $('#return-to-top').click(function () {
    $('body,html').animate({
      scrollTop: 0
    }, 500)
  })
  $('#publication_year').on('change', function () {
    window.location.href = $(this).val()
  })
  
  if ($('.story-content').length > 0) {
    $('.story-content').readmore({
      moreLink: '<a href="#">READ MORE</a>',
      lessLink: '<a href="#">READ LESS</a>'
    })
  }
  $('.im-link').click(function () {
    window.location.href = $(this).data('url');
  })

  $('.dropdown-toggle').click(function() {
      var location = $(this).attr('href');
      window.location.href = location;
      return false;
  });

  // Search Bar
  $('#header .search-bar').click(function(){
      $('#header .search-form').toggleClass('active')
  })
  $('#header .navbar-toggler').click(function(){
      $('#header .search-form').removeClass('active')
  })

})(jQuery)


var currentActiveTitle='';

$('body').on('click', '.pop-whitepaper', function() {
    $('#whitepaper-form').find('input[type="submit"]').show();
    $('#download-btn').attr('href', '').hide();
    $('#whitepaper-form').attr('data-download', $(this).attr('data-url'));
    $('#whitepaper-form').attr('data-title', $(this).attr('data-title'));
    $('#resource-title').text($(this).attr("data-title"));
    $('#resource-text').text($(this).attr("data-text"));
    $('#downloadedFileType').val($(this).attr('data-title'));
    currentActiveTitle = $(this).attr('data-title');
    console.log($(this))
})