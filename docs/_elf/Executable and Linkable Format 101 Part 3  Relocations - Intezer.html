<!DOCTYPE html><html lang="en-US"><head>  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=!0;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f)})(window,document,'script','dataLayer','GTM-KC95766')</script> <meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta http-equiv="cache-control" content="max-age=0" /><meta http-equiv="cache-control" content="no-cache" /><meta http-equiv="expires" content="0" /><meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" /><meta http-equiv="pragma" content="no-cache" /><link rel="icon" type="image/png" href="https://intezer.com/wp-content/themes/intezer-v2/favicon.png" /><link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet"> <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=128260767783916&ev=PageView&noscript=1" /></noscript><title>Executable and Linkable Format 101 Part 3: Relocations - Intezer</title><meta name="description" content="In this post we will introduce the concept of relocations and its relationship with symbols. By the end of this post, the reader will be ready to understand more advanced concepts, such as dynamic linking."/><meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1"/><link rel="canonical" href="https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/" /><meta property="og:locale" content="en_US" /><meta property="og:type" content="article" /><meta property="og:description" content="In this post we will introduce the concept of relocations and its relationship with symbols. By the end of this post, the reader will be ready to understand more advanced concepts, such as dynamic linking." /><meta property="og:url" content="https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/" /><meta property="og:site_name" content="Intezer" /><meta property="article:publisher" content="http://@IntezerLabs" /><meta property="article:tag" content="ELF" /><meta property="article:section" content="ELF" /><meta property="article:published_time" content="2018-04-23T12:47:07+00:00" /><meta property="article:modified_time" content="2020-03-26T11:48:13+00:00" /><meta property="og:updated_time" content="2020-03-26T11:48:13+00:00" /><meta property="og:image" content="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg" /><meta property="og:image:secure_url" content="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg" /><meta property="og:image:width" content="1000" /><meta property="og:image:height" content="667" /><meta name="twitter:card" content="summary" /><meta name="twitter:description" content="In this post we will introduce the concept of relocations and its relationship with symbols. By the end of this post, the reader will be ready to understand more advanced concepts, such as dynamic linking." /><meta name="twitter:title" content="Executable and Linkable Format 101 Part 3: Relocations - Intezer" /><meta name="twitter:site" content="@IntezerLabs" /><meta name="twitter:image" content="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg" /><meta name="twitter:creator" content="@ulexec" /> <script type='application/ld+json' class='yoast-schema-graph yoast-schema-graph--main'>{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://intezer.com/#website","url":"https://intezer.com/","name":"Intezer","inLanguage":"en-US","potentialAction":[{"@type":"SearchAction","target":"https://intezer.com/?s={search_term_string}","query-input":"required name=search_term_string"}]},{"@type":"ImageObject","@id":"https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/#primaryimage","inLanguage":"en-US","url":"https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253.jpg","width":1000,"height":667,"caption":"ELF"},{"@type":"WebPage","@id":"https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/#webpage","url":"https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/","name":"Executable and Linkable Format 101 Part 3: Relocations - Intezer","isPartOf":{"@id":"https://intezer.com/#website"},"inLanguage":"en-US","primaryImageOfPage":{"@id":"https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/#primaryimage"},"datePublished":"2018-04-23T12:47:07+00:00","dateModified":"2020-03-26T11:48:13+00:00","author":{"@id":"https://intezer.com/#/schema/person/a49f39cdb95f926868a0a5829a2fd2ab"},"description":"In this post we will introduce the concept of relocations and its relationship with symbols. By the end of this post, the reader will be ready to understand more advanced concepts, such as dynamic linking.","potentialAction":[{"@type":"ReadAction","target":["https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/"]}]},{"@type":["Person"],"@id":"https://intezer.com/#/schema/person/a49f39cdb95f926868a0a5829a2fd2ab","name":"Ignacio Sanmillan","image":{"@type":"ImageObject","@id":"https://intezer.com/#authorlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/10b456cb056c4459eafd1521de56cd73?s=96&d=mm&r=g","caption":"Ignacio Sanmillan"},"description":"Nacho is a security researcher specializing in reverse engineering and malware analysis. Nacho plays a key role in Intezer's malware hunting and investigation operations, analyzing and documenting new undetected threats. Some of his latest research involves detecting new Linux malware and finding links between different threat actors. Nacho is an adept ELF researcher, having written numerous papers and conducting projects implementing state-of-the-art obfuscation and anti-analysis techniques in the ELF file format.","sameAs":["https://twitter.com/ulexec"]}]}</script> <link rel='dns-prefetch' href='//www.google.com' /><link rel="alternate" type="application/rss+xml" title="Intezer &raquo; Feed" href="https://intezer.com/feed/" /><link rel="alternate" type="application/rss+xml" title="Intezer &raquo; Comments Feed" href="https://intezer.com/comments/feed/" /><link rel='stylesheet' id='wp-block-library-css'  href='https://intezer.com/wp-includes/css/dist/block-library/style.min.css?ver=5.3.2' media='all' /><link data-minify="1" rel='stylesheet' id='contact-form-7-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/contact-form-7/includes/css/styles-58f1988c24372a90445566506572b6e8.css' media='all' /><link data-minify="1" rel='stylesheet' id='bootstrap_css-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/themes/intezer-v2/css/bootstrap-77f4789737eddcd7b86865f831aca83a.css' media='all' /><link rel='stylesheet' id='fontawesome_css-css'  href='https://intezer.com/wp-content/themes/intezer-v2/css/font-awesome.min.css?ver=5.3.2' media='all' /><link data-minify="1" rel='stylesheet' id='main_css-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/themes/intezer-v2/style-b6ee4d7da6c603e1c306a9787271b107.css' media='all' /><link data-minify="1" rel='stylesheet' id='slb_core-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/simple-lightbox/client/css/app-df3bdc18a0d5ffe57a5b276454890a68.css' media='all' /><link rel='stylesheet' id='addtoany-css'  href='https://intezer.com/wp-content/plugins/add-to-any/addtoany.min.css?ver=1.15' media='all' /><link data-minify="1" rel='stylesheet' id='cf7cf-style-css'  href='https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/cf7-conditional-fields/style-678fd78ee455b3d3b38e874ec117933c.css' media='all' /><link rel='https://api.w.org/' href='https://intezer.com/wp-json/' /><link rel='shortlink' href='https://intezer.com/?p=1495' /><link rel="alternate" type="application/json+oembed" href="https://intezer.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-and-linkable-format-101-part-3-relocations%2F" /><link rel="alternate" type="text/xml+oembed" href="https://intezer.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-and-linkable-format-101-part-3-relocations%2F&#038;format=xml" /><link data-minify="1" rel="stylesheet" href="https://intezer.com/wp-content/cache/ezcache/intezer.com/min/wp-content/plugins/wp-synhighlight/themes/default/wp-synhighlighter-2fc04b6d82a5761012ae19436bfc1091.css" type="text/css" media="screen" /><link rel="icon" href="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-32x32.png" sizes="32x32" /><link rel="icon" href="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-192x192.png" sizes="192x192" /><link rel="apple-touch-icon-precomposed" href="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-180x180.png" /><meta name="msapplication-TileImage" content="https://intezer.com/wp-content/uploads/2017/07/cropped-intezer-logo-270x270.png" /><style type="text/css" id="wp-custom-css">footer .footer-1{flex-direction:row}footer .footer-1>li{min-width:auto;padding:0 10px}#contact-us input,#contact-us textarea{color:#757575}#whitepaper-form input,#whitepaper-form textarea{color:#757575}#technology-4 h2{font-size:45px;color:#000;font-family:"Museo300",sans-serif;margin:0 0 20px 0}#technology-4 p{font-size:19px;color:#505157;line-height:1.5;max-width:90%;display:inline-block;font-weight:300}.owl-carousel .owl-nav .owl-prev,.owl-carousel .owl-nav .owl-next,.owl-carousel .owl-dot{font-family:'fontAwesome'}.owl-carousel .owl-nav .owl-prev:before{content:"\f053";float:left;position:absolute;left:-60px;top:60px;opacity:.3}.owl-carousel .owl-nav .owl-next:after{content:"\f054";float:right;position:absolute;right:-60px;top:60px;opacity:.3}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner{max-width:1140px!important;padding:0 10px!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner a#hs-eu-confirmation-button{margin-top:10px}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p{width:85%;float:left;font-size:15px}.wpcf7 p{margin-bottom:0}.cf-field{float:left;width:50%;padding-left:5px;padding-right:0}.cf-field-left{padding-left:0;padding-right:5px}.cf-field.cf-field-wide{width:100%;padding:0}@media (min-width:640px) and (max-width:1350px){.meta-date strong,.meta-date span{margin-top:5px;margin-bottom:25px}}@media (max-width:900px){.meta-date strong,.meta-date span{margin-top:1rem}#technology-4 h2{font-size:35px}}@media (max-width:768px){.cf-field{padding:0;width:100%}.cf-field-left{padding:0}div#hs-eu-cookie-confirmation{bottom:0!important;top:auto!important;position:fixed!important}div#hs-eu-cookie-confirmation div#hs-eu-cookie-confirmation-inner p{width:100%;float:none}}.comeet-modal-open .comeet-modal{opacity:1}.comeet-intezer .entry-header{display:none}.comeet-intezer .comeet-outer-wrapper .comeet-groups-list .comeet-group-name,.comeet-intezer .comeet-outer-wrapper .comeet-groups-list .comeet-group-name a{margin-bottom:20px;width:100%;font-size:13px;font-weight:700;line-height:1.62;letter-spacing:.5px;color:#308aff;text-align:left}.comeet-position-name{font-family:"Museo500",sans-serif;font-size:17px;font-weight:500;line-height:1.35;letter-spacing:.57px;color:#233b52;padding:0 20px 0 20px;margin:0}.comeet-position-meta{font-size:11px;font-weight:700;font-stretch:normal;font-style:normal;line-height:1.5;letter-spacing:.44px;color:#627d98;min-height:46px;padding:20px 20px 6px 20px}.comeet-intezer a.comeet-position{display:block;border-bottom:0 solid #d5d5d5;padding-top:0;min-height:130px}.comeet-intezer .comeet-list li{background-color:#fff;width:31.5%;min-width:31.5%;border-radius:25px;border:solid 2px #ccd8e4;overflow:hidden;transition:all .3s;min-height:130px;margin-bottom:2.25%;margin-right:2.25%}.comeet-intezer .comeet-list li:hover{border:solid 2px #308aff}.comeet-intezer .comeet-list li:nth-child(3n){margin-right:0%}.comeet-intezer .comeet-list ul{display:flex;flex-direction:row;flex-wrap:wrap;align-content:flex-start;list-style:none;margin:0;padding:0}.comeet-single-job .entry-title,.comeet-single-job .all-jobs-link{display:none}.comeet-position-info{color:#627d98;font-size:13px;line-height:1.54;margin:14px 0}.comeet-single-job .comeet-position-info h4,.comeet-single-job .comeet-position-info h4,.comeet-single-job .comeet-apply h4{font-size:17px;font-family:"Museo500",sans-serif;color:#233b52;font-weight:500}.comeet-single-job ul{padding:0 0 0 25px;list-style-type:none;margin:20px 0}.comeet-single-job ul li{margin:14px 0}.comeet-single-job ul li:before{width:5px;overflow:hidden;margin-right:14px;color:#308aff;content:'-';position:relative;margin-left:-20px;font-weight:700;font-size:20px;line-height:17px}.comeet-single-job .comeet-outer-wrapper{padding:0 18%}.comeet-single-job .comeet-outer-wrapper .comeet-position-requirements ul{list-style:none}.comeet-single-job article{width:100%}@media (max-width:780px){.comeet-intezer .comeet-list li{width:100%;margin-bottom:4%;margin-right:0%}.comeet-single-job .comeet-outer-wrapper{padding:0 0%}.comeet-single-job article .container{width:100%;padding:0}}</style> <script src="https://intezer.com/wp-content/cache/ezcache/intezer.com/min/9f9b6055bfa86b7a2468c5291133c204.js" data-minify="1"></script> </head><body class="post-template-default single single-post postid-1495 single-format-standard wp-custom-logo executable-and-linkable-format-101-part-3-relocations"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KC95766"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="background-pop"></div><header id="header"><nav class="navbar navbar-toggleable-sm navbar-inverse bg-faded fixed-top" id="main-menu"> <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
data-target="#top-navbar" aria-controls="top-navbar" aria-expanded="false"
aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button><div class="search-bar show-mobile"> <img src="https://intezer.com/wp-content/themes/intezer-v2/images/search-ico.png" alt=""></div><div class="show-mobile"><form role="search" method="get" class="search-form" action="https://intezer.com/"> <label> <span class="screen-reader-text">Search for:</span> <input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" /> </label> <input type="submit" class="search-submit" value="Search" /></form></div> <a class="navbar-brand" href="https://intezer.com/"> <a class="logo-link" href="https://intezer.com"><img class="logo-img" src="https://intezer.com/wp-content/uploads/2017/07/intezer-logo.png" alt="intezer"></a> </a><div class="collapse navbar-collapse" id="top-navbar"><ul id="menu-top-menu" class="navbar-nav ml-auto"><li id="menu-item-239" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-239 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Products" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Products </a><ul role="menu" class="dropdown-menu"><li id="menu-item-5071" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5071 nav-item"><a class="nav-link" title="Intezer Analyze" href="https://intezer.com/intezer-analyze/">Intezer Analyze</a></li><li id="menu-item-6685" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6685 nav-item"><a class="nav-link" title="Intezer Protect" href="https://intezer.com/intezer-protect/">Intezer Protect</a></li></ul></li><li id="menu-item-7240" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7240 nav-item"><a class="nav-link" title="Why Intezer" href="https://intezer.com/why-intezer/">Why Intezer</a></li><li id="menu-item-3097" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3097 nav-item"><a class="nav-link" title="Technology" href="https://intezer.com/technology/">Technology</a></li><li id="menu-item-131" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-131 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Company" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Company </a><ul role="menu" class="dropdown-menu"><li id="menu-item-70" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-70 nav-item"><a class="nav-link" title="About" href="https://intezer.com/about/">About</a></li><li id="menu-item-7095" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7095 nav-item"><a class="nav-link" title="Events" href="https://intezer.com/intezer-events/">Events</a></li><li id="menu-item-7096" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7096 nav-item"><a class="nav-link" title="News" href="https://intezer.com/intezer-news/">News</a></li><li id="menu-item-8417" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8417 nav-item"><a class="nav-link" title="Careers" href="https://intezer.com/careers/">Careers</a></li><li id="menu-item-114" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-114 nav-item"><a class="nav-link" title="Contact Us" href="https://intezer.com/contact-us/">Contact Us</a></li></ul></li><li id="menu-item-3061" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3061 nav-item"><a class="nav-link" title="Partners" href="https://intezer.com/partners/">Partners</a></li><li id="menu-item-125" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-125 nav-item"><a class="nav-link" title="Blog" href="https://intezer.com/blog/">Blog</a></li><li id="menu-item-1368" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1368 nav-item"><a class="nav-link" title="Resources" href="https://intezer.com/resources/">Resources</a></li><li id="menu-item-1028" class="try-now desktop-cta menu-item menu-item-type-custom menu-item-object-custom menu-item-1028 nav-item"><a class="nav-link" title="Get Started for Free" href="/get-started/"><span class="glyphicon Try it Now"></span>&nbsp;Get Started for Free</a></li><li id="menu-item-5106" class="try-now mobile-cta menu-item menu-item-type-custom menu-item-object-custom menu-item-5106 nav-item"><a class="nav-link" title="Get Started for Free" href="/get-started/"><span class="glyphicon Try our free Community Edition"></span>&nbsp;Get Started for Free</a></li></ul><div class="search-bar show-desktop"> <img src="https://intezer.com/wp-content/themes/intezer-v2/images/search-ico.png" alt=""></div><div class="show-desktop"><form role="search" method="get" class="search-form" action="https://intezer.com/"> <label> <span class="screen-reader-text">Search for:</span> <input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" /> </label> <input type="submit" class="search-submit" value="Search" /></form></div></div></nav></header><div class="popup"><div role="form" class="wpcf7" id="wpcf7-f468-o1" lang="en-US" dir="ltr"><div class="screen-reader-response"></div><form action="/blog/elf/executable-and-linkable-format-101-part-3-relocations/#wpcf7-f468-o1" method="post" class="wpcf7-form clearfix" novalidate="novalidate" id="request-demo-form"><div style="display: none;"> <input type="hidden" name="_wpcf7" value="468" /> <input type="hidden" name="_wpcf7_version" value="5.1.7" /> <input type="hidden" name="_wpcf7_locale" value="en_US" /> <input type="hidden" name="_wpcf7_unit_tag" value="wpcf7-f468-o1" /> <input type="hidden" name="_wpcf7_container_post" value="0" /> <input type="hidden" name="_wpcf7cf_hidden_group_fields" value="" /> <input type="hidden" name="_wpcf7cf_hidden_groups" value="" /> <input type="hidden" name="_wpcf7cf_visible_groups" value="" /> <input type="hidden" name="_wpcf7cf_repeaters" value="[]" /> <input type="hidden" name="_wpcf7cf_steps" value="{}" /> <input type="hidden" name="_wpcf7cf_options" value="{&quot;form_id&quot;:468,&quot;conditions&quot;:[{&quot;then_field&quot;:&quot;group-570&quot;,&quot;and_rules&quot;:[{&quot;if_field&quot;:&quot;mx_Country&quot;,&quot;operator&quot;:&quot;equals&quot;,&quot;if_value&quot;:&quot;United States&quot;}]}],&quot;settings&quot;:{&quot;animation&quot;:&quot;yes&quot;,&quot;animation_intime&quot;:200,&quot;animation_outtime&quot;:200,&quot;notice_dismissed&quot;:false}}" /> <input type="hidden" name="g-recaptcha-response" value="" /></div><div class="form-header"></div><div class="cf-field cf-field-left"> <span class="cf-label">First Name</span><br /> <span class="wpcf7-form-control-wrap FirstName"><input type="text" name="FirstName" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required fname w-98" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field"> <span class="cf-label">Last Name</span><br /> <span class="wpcf7-form-control-wrap LastName"><input type="text" name="LastName" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required w-98" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field cf-field-left"> <span class="cf-label">Job Title</span><br /> <span class="wpcf7-form-control-wrap JobTitle"><input type="text" name="JobTitle" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required w-98" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field"> <span class="cf-label">Company</span><br /> <span class="wpcf7-form-control-wrap Company"><input type="text" name="Company" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-validates-as-required company" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field cf-field-left"> <span class="cf-label">Email</span><br /> <span class="wpcf7-form-control-wrap EmailAddress"><input type="email" name="EmailAddress" value="" size="40" class="wpcf7-form-control wpcf7-text wpcf7-email wpcf7-validates-as-required wpcf7-validates-as-email email" aria-required="true" aria-invalid="false" /></span></div><div class="cf-field"> <span class="cf-label">Country</span><br /> <span class="wpcf7-form-control-wrap mx_Country"><select name="mx_Country" class="wpcf7-form-control wpcf7-select wpcf7-validates-as-required country" aria-required="true" aria-invalid="false"><option value=""></option><option value="United States">United States</option><option value="Canada">Canada</option><option value="Afghanistan">Afghanistan</option><option value="Albania">Albania</option><option value="Algeria">Algeria</option><option value="Andorra">Andorra</option><option value="Angola">Angola</option><option value="Antigua and Barbuda">Antigua and Barbuda</option><option value="Argentina">Argentina</option><option value="Armenia">Armenia</option><option value="Aruba">Aruba</option><option value="Australia">Australia</option><option value="Austria">Austria</option><option value="Azerbaijan">Azerbaijan</option><option value="Bahamas">Bahamas</option><option value="Bahrain">Bahrain</option><option value="Bangladesh">Bangladesh</option><option value="Barbados">Barbados</option><option value="Belarus">Belarus</option><option value="Belgium">Belgium</option><option value="Belize">Belize</option><option value="Benin">Benin</option><option value="Bermuda">Bermuda</option><option value="Bhutan">Bhutan</option><option value="Bolivia">Bolivia</option><option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option><option value="Botswana">Botswana</option><option value="Brazil">Brazil</option><option value="Brunei">Brunei</option><option value="Bulgaria">Bulgaria</option><option value="Burkina Faso">Burkina Faso</option><option value="Burundi">Burundi</option><option value="Cambodia">Cambodia</option><option value="Cameroon">Cameroon</option><option value="Cape Verde">Cape Verde</option><option value="Cayman Islands">Cayman Islands</option><option value="Central African Republic">Central African Republic</option><option value="Chad">Chad</option><option value="Chile">Chile</option><option value="China">China</option><option value="Colombia">Colombia</option><option value="Comoros">Comoros</option><option value="Democratic Republic of the Congo (Kinshasa)">Democratic Republic of the Congo (Kinshasa)</option><option value="Congo, Republic of(Brazzaville)">Congo, Republic of(Brazzaville)</option><option value="Costa Rica">Costa Rica</option><option value="Croatia">Croatia</option><option value="Cuba">Cuba</option><option value="Cyprus">Cyprus</option><option value="Czech Republic">Czech Republic</option><option value="Denmark">Denmark</option><option value="Djibouti">Djibouti</option><option value="Dominica">Dominica</option><option value="Dominican Republic">Dominican Republic</option><option value="East Timor (Timor-Leste)">East Timor (Timor-Leste)</option><option value="Ecuador">Ecuador</option><option value="Egypt">Egypt</option><option value="El Salvador">El Salvador</option><option value="Equatorial Guinea">Equatorial Guinea</option><option value="Eritrea">Eritrea</option><option value="Estonia">Estonia</option><option value="Ethiopia">Ethiopia</option><option value="Fiji">Fiji</option><option value="Finland">Finland</option><option value="France">France</option><option value="Gabon">Gabon</option><option value="Gambia">Gambia</option><option value="Georgia">Georgia</option><option value="Germany">Germany</option><option value="Ghana">Ghana</option><option value="Gibraltar">Gibraltar</option><option value="Greece">Greece</option><option value="Grenada">Grenada</option><option value="Guatemala">Guatemala</option><option value="Guinea">Guinea</option><option value="Guinea-Bissau">Guinea-Bissau</option><option value="Guyana">Guyana</option><option value="Haiti">Haiti</option><option value="Honduras">Honduras</option><option value="Hong Kong">Hong Kong</option><option value="Hungary">Hungary</option><option value="Iceland">Iceland</option><option value="India">India</option><option value="Indonesia">Indonesia</option><option value="Iran, Islamic Republic of">Iran, Islamic Republic of</option><option value="Iraq">Iraq</option><option value="Ireland">Ireland</option><option value="Israel">Israel</option><option value="Italy">Italy</option><option value="Ivory Coast">Ivory Coast</option><option value="Jamaica">Jamaica</option><option value="Japan">Japan</option><option value="Jordan">Jordan</option><option value="Kazakhstan">Kazakhstan</option><option value="Kenya">Kenya</option><option value="Kiribati">Kiribati</option><option value="Korea, Democratic People&#039;s Republic of(North Korea)">Korea, Democratic People&#039;s Republic of(North Korea)</option><option value="Korea, Republic of">Korea, Republic of</option><option value="Kosovo">Kosovo</option><option value="Kuwait">Kuwait</option><option value="Kyrgyzstan">Kyrgyzstan</option><option value="Laos, People&#039;s Democratic Republic">Laos, People&#039;s Democratic Republic</option><option value="Latvia">Latvia</option><option value="Lebanon">Lebanon</option><option value="Lesotho">Lesotho</option><option value="Liberia">Liberia</option><option value="Libya">Libya</option><option value="Liechtenstein">Liechtenstein</option><option value="Lithuania">Lithuania</option><option value="Luxembourg">Luxembourg</option><option value="Macau">Macau</option><option value="Macedonia, Rep. of">Macedonia, Rep. of</option><option value="Madagascar">Madagascar</option><option value="Malawi">Malawi</option><option value="Malaysia">Malaysia</option><option value="Maldives">Maldives</option><option value="Mali">Mali</option><option value="Malta">Malta</option><option value="Marshall Islands">Marshall Islands</option><option value="Mauritania">Mauritania</option><option value="Mauritius">Mauritius</option><option value="Mexico">Mexico</option><option value="Micronesia, Federal States of">Micronesia, Federal States of</option><option value="Moldova, Republic of">Moldova, Republic of</option><option value="Monaco">Monaco</option><option value="Mongolia">Mongolia</option><option value="Montenegro">Montenegro</option><option value="Morocco">Morocco</option><option value="Mozambique">Mozambique</option><option value="Myanmar, Burma">Myanmar, Burma</option><option value="Namibia">Namibia</option><option value="Nauru">Nauru</option><option value="Nepal">Nepal</option><option value="Netherlands">Netherlands</option><option value="New Caledonia">New Caledonia</option><option value="New Zealand">New Zealand</option><option value="Nicaragua">Nicaragua</option><option value="Niger">Niger</option><option value="Nigeria">Nigeria</option><option value="Norway">Norway</option><option value="Oman">Oman</option><option value="Pakistan">Pakistan</option><option value="Palau">Palau</option><option value="Palestinian territories">Palestinian territories</option><option value="Panama">Panama</option><option value="Papua New Guinea">Papua New Guinea</option><option value="Paraguay">Paraguay</option><option value="Peru">Peru</option><option value="Philippines">Philippines</option><option value="Poland">Poland</option><option value="Portugal">Portugal</option><option value="Puerto Rico">Puerto Rico</option><option value="Qatar">Qatar</option><option value="Romania">Romania</option><option value="Russian Federation">Russian Federation</option><option value="Rwanda">Rwanda</option><option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option><option value="Saint Lucia">Saint Lucia</option><option value="Saint Vincent and the Grenadines">Saint Vincent and the Grenadines</option><option value="Samoa">Samoa</option><option value="San Marino">San Marino</option><option value="Sao Tome and Principe">Sao Tome and Principe</option><option value="Saudi Arabia">Saudi Arabia</option><option value="Senegal">Senegal</option><option value="Serbia">Serbia</option><option value="Seychelles">Seychelles</option><option value="Sierra Leone">Sierra Leone</option><option value="Singapore">Singapore</option><option value="Slovakia (Slovak Republic)">Slovakia (Slovak Republic)</option><option value="Slovenia">Slovenia</option><option value="Solomon Islands">Solomon Islands</option><option value="Somalia">Somalia</option><option value="South Africa">South Africa</option><option value="South Sudan">South Sudan</option><option value="Spain">Spain</option><option value="Sri Lanka">Sri Lanka</option><option value="Sudan">Sudan</option><option value="Suriname">Suriname</option><option value="Swaziland">Swaziland</option><option value="Sweden">Sweden</option><option value="Switzerland">Switzerland</option><option value="Syria, Syrian Arab Republic">Syria, Syrian Arab Republic</option><option value="Taiwan">Taiwan</option><option value="Tajikistan">Tajikistan</option><option value="Tanzania; officially the United Republic of Tanzania">Tanzania; officially the United Republic of Tanzania</option><option value="Thailand">Thailand</option><option value="Tibet">Tibet</option><option value="Togo">Togo</option><option value="Tonga">Tonga</option><option value="Trinidad and Tobago">Trinidad and Tobago</option><option value="Tunisia">Tunisia</option><option value="Turkey">Turkey</option><option value="Turkmenistan">Turkmenistan</option><option value="Tuvalu">Tuvalu</option><option value="Uganda">Uganda</option><option value="Ukraine">Ukraine</option><option value="United Arab Emirates">United Arab Emirates</option><option value="United Kingdom">United Kingdom</option><option value="Uruguay">Uruguay</option><option value="Uzbekistan">Uzbekistan</option><option value="Vanuatu">Vanuatu</option><option value="Vatican City State (Holy See)">Vatican City State (Holy See)</option><option value="Venezuela">Venezuela</option><option value="Vietnam">Vietnam</option><option value="Yemen">Yemen</option><option value="Zambia">Zambia</option><option value="Zimbabwe">Zimbabwe</option></select></span></p><div data-id="group-570" data-orig_data_id="group-570" data-clear_on_hide data-class="wpcf7cf_group"> <span class="wpcf7-form-control-wrap mx_State"><select name="mx_State" class="wpcf7-form-control wpcf7-select country" aria-invalid="false"><option value="">Select State</option><option value="Alabama">Alabama</option><option value="Alaska">Alaska</option><option value="American Samoa">American Samoa</option><option value="Arizona">Arizona</option><option value="Arkansas">Arkansas</option><option value="California">California</option><option value="Colorado">Colorado</option><option value="Connecticut">Connecticut</option><option value="Delaware">Delaware</option><option value="District of Columbia">District of Columbia</option><option value="Florida">Florida</option><option value="Georgia">Georgia</option><option value="Guam">Guam</option><option value="Hawaii">Hawaii</option><option value="Idaho">Idaho</option><option value="Illinois">Illinois</option><option value="Indiana">Indiana</option><option value="Iowa">Iowa</option><option value="Kansas">Kansas</option><option value="Kentucky">Kentucky</option><option value="Louisiana">Louisiana</option><option value="Maine">Maine</option><option value="Maryland">Maryland</option><option value="Massachusetts">Massachusetts</option><option value="Michigan">Michigan</option><option value="Minnesota">Minnesota</option><option value="Mississippi">Mississippi</option><option value="Missouri">Missouri</option><option value="Montana">Montana</option><option value="Nebraska">Nebraska</option><option value="Nevada">Nevada</option><option value="New Hampshire">New Hampshire</option><option value="New Jersey">New Jersey</option><option value="New Mexico">New Mexico</option><option value="New York">New York</option><option value="North Carolina">North Carolina</option><option value="North Dakota">North Dakota</option><option value="Northern Mariana Islands">Northern Mariana Islands</option><option value="Ohio">Ohio</option><option value="Oklahoma">Oklahoma</option><option value="Oregon">Oregon</option><option value="Pennsylvania">Pennsylvania</option><option value="Puerto Rico">Puerto Rico</option><option value="Rhode Island">Rhode Island</option><option value="South Carolina">South Carolina</option><option value="South Dakota">South Dakota</option><option value="Tennessee">Tennessee</option><option value="Texas">Texas</option><option value="United States Minor Outlying Islands">United States Minor Outlying Islands</option><option value="Utah">Utah</option><option value="Vermont">Vermont</option><option value="Virgin Islands">Virgin Islands</option><option value="Virginia">Virginia</option><option value="Washington">Washington</option><option value="West Virginia">West Virginia</option><option value="Wisconsin">Wisconsin</option><option value="Wyoming">Wyoming</option></select></span></div></div> <input type="hidden" name="form-title" value="" class="wpcf7-form-control wpcf7-hidden form-title" /><p><input type="submit" value="Send Request" class="wpcf7-form-control wpcf7-submit btn btn-primary" /></p><div class="wpcf7-response-output wpcf7-display-none"></div></form></div></div><div id="primary" class="content-area"><div class="container"><div class="single-post-page"><h1 class="entry-title t-dianne">Executable and Linkable Format 101 Part 3: Relocations</h1><div class="row top-meta"><div class="col-md-12"><div class="author-box clearfix"><img src="https://intezer.com/wp-content/uploads/2020/01/eJRF6CeP_400x400-60x60.jpg" class="user-photo"><div class="user-bio"><span class="author-light">Written by </span><span class="author-name"> Ignacio Sanmillan</span><span class="author-date"> - 23 April 2018</span></div></div></div><div class="main-blog-image"><img src="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253-1000x475.jpg" class="featured-img"></div></div><div class="row"><div class="col-md-2"><div class="side-blog-btn">Join our free community<a href="https://analyze.intezer.com" target="_blank" class="btn btn-prim dodger">Get started</a></div><div class="side-blog-share"">Share Article<div class="a2a_kit a2a_kit_size_ addtoany_list" data-a2a-url="https://intezer.com/blog/elf/executable-and-linkable-format-101-part-3-relocations/" data-a2a-title="Executable and Linkable Format 101 Part 3: Relocations"><a class="a2a_button_facebook" href="https://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-and-linkable-format-101-part-3-relocations%2F&amp;linkname=Executable%20and%20Linkable%20Format%20101%20Part%203%3A%20Relocations" title="Facebook" rel="nofollow noopener" target="_blank"><img src="/wp-content/themes/intezer-v2/images/social/facebook.png" alt="Facebook"></a><a class="a2a_button_twitter" href="https://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-and-linkable-format-101-part-3-relocations%2F&amp;linkname=Executable%20and%20Linkable%20Format%20101%20Part%203%3A%20Relocations" title="Twitter" rel="nofollow noopener" target="_blank"><img src="/wp-content/themes/intezer-v2/images/social/twitter.png" alt="Twitter"></a><a class="a2a_button_linkedin" href="https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fintezer.com%2Fblog%2Felf%2Fexecutable-and-linkable-format-101-part-3-relocations%2F&amp;linkname=Executable%20and%20Linkable%20Format%20101%20Part%203%3A%20Relocations" title="LinkedIn" rel="nofollow noopener" target="_blank"><img src="/wp-content/themes/intezer-v2/images/social/linkedin.png" alt="LinkedIn"></a></div></div></div><div class="col-md-8"><div class="single-post-content"><p>In our<a href="http://intezer.com/executable-linkable-format-101-part-2-symbols/" target="_blank" rel="noopener noreferrer"> previous post,</a> we went through the concept of symbols and their functionality. In this post we will introduce the concept of relocations and its relationship with symbols.</p><p>By the end of this post, the reader will be ready to understand more advanced concepts, such as dynamic linking, which we will cover in depth in our next post.</p><p>&nbsp;</p><p><strong> 1. Defining Relocations</strong></p><p>In our previous post we covered what it means for a file to have symbolic information &#8211; when a file contains symbolic information it means that it contains source code exported metadata, in order to better interpret the generated machine code.</p><p>However, symbolic information by itself is useless. Symbolic references and symbolic definitions have to be connected with one another. The mechanism of connecting symbolic references with their correspondent symbolic definitions is what is know as Relocations.</p><p>Let’s say we have a program that adds the value of two global variables together. In order for those variables to be successfully referenced in our program, their addresses within the process virtual address space have to be resolved. As an additional example, If our program is calling a function from an external dependency, the address of that function will also have to be computed prior to transferring control of execution to it. These two scenarios are examples of where relocations have to be applied.</p><p>During the compilation process of a program there is a specific stage were relocatable objects are generated. These relocatable objects contain all the information required to map symbolic references to its corresponding definitions. Populating symbolic references on symbolic definitions takes place during the linking phase of the compilation process.</p><p><a href="http://intezer.com/wp-content/uploads/2018/04/2018-04-23-152639_924x127_scrot.png" data-slb-group="post-images" data-slb-group="slb" data-slb-active="1" data-slb-asset="79415679" data-slb-internal="0"><img class="aligncenter wp-image-1509" src="http://intezer.com/wp-content/uploads/2018/04/2018-04-23-152639_924x127_scrot-300x41.png" alt="Defining Relocations" width="805" height="110" srcset="https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152639_924x127_scrot-300x41.png 300w, https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152639_924x127_scrot-768x106.png 768w, https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152639_924x127_scrot.png 924w" sizes="(max-width: 805px) 100vw, 805px" /></a></p><p style="text-align: center;">Figure1: compilation process</p><p>There are different types of relocatable files:</p><ul><li>Generic object files (*.o).</li><li>Kernel object files (*.ko).</li><li>Shared object files (*.so).</li></ul><p>Generic object files are the ones that are used for static linking, they are only relevant in the compilation process and essentially, any given symbolic definition will become part of the main executable being generated.</p><p>Obviously, this linking type has its benefits and flaws. On the benefits side, we should note that there is no need to rely on external dependencies to make the main executable work across different hosts. On the other hand, statically linked executables can become particularly large, since all needed dependencies of a given program will become part of the generated binary itself as previously mentioned.</p><p>Furthermore, another type of relocatable object are Kernel objects. These type of objects support being loaded to the kernel as a module (commonly known as LKM), without the need to restart the system. We will talk about Loadable Kernel Modules more thoroughly in future posts.</p><p>There are also shared objects. These type of relocatable files support being linked on runtime, and they may be shared across different processes.<br /> Consequently, relocations of dynamic dependencies have to be done at runtime. This process is known as Dynamic Linking.</p><p>The reason these relocations take place at runtime, is that as opposed to static linking, the symbolic definitions do not exist within the main binary’s context, but within external shared objects. These dynamic references will not be populated until the correspondent external dependencies are loaded into memory.</p><p>Image bases of dynamically linked dependencies are not deterministic, since they will differ even between different process instances of the same executable.<br /> Furthermore, as an interesting fact, dynamic dependencies in Linux systems do not have preferred based image bases, as is the case with Windows systems &#8211; Process A libc.so will not be mapped at the same address as process B libc.so.</p><p>&nbsp;</p><p><strong> 2. Relocation entries</strong></p><p>Relocation information is held in relocatable entries, located in specific relocation sections within an ELF object. These entries are implemented in the form of structures. There are two different Relocation entry structures: Elfxx_Rel and Elfxx_Rela:</p><p><a href="http://intezer.com/wp-content/uploads/2018/04/2018-04-23-152616_451x271_scrot.png" data-slb-group="post-images" data-slb-group="slb" data-slb-active="1" data-slb-asset="106003893" data-slb-internal="0"><img class="aligncenter wp-image-1512" src="http://intezer.com/wp-content/uploads/2018/04/2018-04-23-152616_451x271_scrot-300x180.png" alt="Relocation entries" width="409" height="246" srcset="https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152616_451x271_scrot-300x180.png 300w, https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152616_451x271_scrot.png 451w" sizes="(max-width: 409px) 100vw, 409px" /></a></p><p style="text-align: center;">Figure 2: ELF32 relocation entries</p><p>As seen in the figure above, the only difference between both structures is that Elfxx_Rela contains one additional field dedicated as a relocation addend.<br /> It is important to note that these relocation entry types are mutually exclusive within the context of a given ELF object. This means that if one type of entry is used, the other one will not be used consequently.</p><p>The reason for using one type of entry over the other, is usually architecture dependant.<br /> For example, in x86 only Elf32_Rel is used, while on x86_64 only Elf64_Rela is used. However this is not always valid for every architecture, for instance, SPARC always uses some instance of Elfxx_Rela.</p><p>The different fields in these structures are the following:</p><ul><li>r_offset: This field holds the location where a particular relocation has to take place, however it may have different interpretations depending on ELF object type.<ul><li>For ET_REL type binaries, this value denotes an offset within a section header. in which the relocations have to take place</li><li>For ET_EXEC type binaries, this value denotes a virtual address affected by a relocation</li></ul></li><li>r_info: This field denotes both the symbol index within a symbol table of the correspondent symbol that has to be relocated, as well as the relocation type for that specific symbol. Both of these pieces of information can be retrieved from this field using the following macros:<ul><li>ELF32_R_SYM(info) ((info)&gt;&gt;8)</li><li>ELF32_R_TYPE(info) ((unsigned char)(info))</li><li>ELF64_R_SYM(info) ((info)&gt;&gt;32)</li><li>ELF64_R_TYPE(info) ((Elf64_Word)(info))</li></ul></li><li>r_addend: This field specifies a constant addend to be added to compute the value to be stored in a given relocation reference.</li></ul><p>These relocation entries are always found in some relocation section. Every relocation section may reference two additional sections.</p><ul><li>A relocation section will always be linked to its correspondent symbol table. This symbol table can be located as a section in the Section Header Table, and its index can be retrieved by the sh_link field of the relocation section’s Elfxx_Shdr instance.</li><li>As previously mentioned, if a file is of type ET_REL, a given relocation entry’s r_offset will be an offset to a particular section where a relocation has to take place. The section index where to apply that offset can be retrieved by the relocation section’s Elfxx_Shdr sh_info field.</li></ul><p>The following diagram illustrates the previous relationships of the relocation section.</p><p><a href="http://intezer.com/wp-content/uploads/2018/04/2018-04-23-152545_877x731_scrot.png" data-slb-group="post-images" data-slb-group="slb" data-slb-active="1" data-slb-asset="1805914420" data-slb-internal="0"><img class="aligncenter wp-image-1513" src="http://intezer.com/wp-content/uploads/2018/04/2018-04-23-152545_877x731_scrot-300x250.png" alt="" width="755" height="630" srcset="https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152545_877x731_scrot-300x250.png 300w, https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152545_877x731_scrot-768x640.png 768w, https://intezer.com/wp-content/uploads/2018/04/2018-04-23-152545_877x731_scrot.png 877w" sizes="(max-width: 755px) 100vw, 755px" /></a></p><p style="text-align: center;">Figure 3 : Section relationships involved in relocation entries.</p><p>The diagram above is a generic representation of the relationship between the different data structures involved in relocations. As mentioned before, the relocation section is linked to two other sections. One of them is the symbol table, where the symbols that will be relocated are held. In this case, the section is the .dynsym section, the symbol table that holds symbols for Dynamic Linking.</p><p>The additional section linked to the relocation section is where the relocations are going to take place. In this case, the section is the .got.plt section, which is a specific section dedicated to hold a table of pointers, as an interface for the application to access relocated dynamically linked procedures addresses. This table of pointers is also known as the Global Offset Table (GOT). We will discuss the exact usage and mechanisms involved with this section in the next post.</p><p>&nbsp;</p><p><strong> 3. Relocation types:</strong></p><p>As mentioned before, the r_info field of Elfxx_Rel and Elfxx_Rela contains two encoded values, which are the symbol index where the relocation is being applied to and the relocation type to apply accordingly. There are various relocations types and usually, these relocation types are architecture dependant. In this post, we cover relocation types of x86 and x86_64, but it is advised to rely on the ELF documentation of a given architecture to know its specific relocation types.</p><p>The difference between relocation types resides in the way the relocated value is calculated.<br /> There are different variables that can potentially be involved in the calculation process. These variables are:</p><ul><li>A: Addend of Elfxx_Rela entries.</li><li>B: Image base where the shared object was loaded in process virtual address space.</li><li>G: Offset to the GOT relative to the address of the correspondent relocation<br /> entry’s symbol.</li><li>GOT: Address of the Global Offset Table</li><li>L: Section offset or address of the procedure linkage table (PLT, .got.plt).</li><li>P: The section offset or address of the storage unit being relocated.<br /> retrieved via r_offset relocation entry’s field.</li><li>S: Relocation entry’s correspondent symbol value.</li><li>Z: Size of Relocations entry’s symbol.</li></ul><p>Usually the relocation type name is descriptible enough to interpret its needed calculation. The following list presents the most common suffix names and their meaning for different relocation types in x86 and x86_64:</p><p>Generic relocation suffixes:</p><ul><li>*_NONE: Neglected entry.</li><li>*_64: qword relocation value.</li><li>*_32: dword relocation value.</li><li>*_16: word relocation value.</li><li>*_8: byte relocation value.</li><li>*_PC: relative to program counter.</li><li>*_GOT: relative to GOT.</li><li>*_PLT: relative to PLT (Procedure Linkage Table).</li><li>*_COPY: value copied directly from shared object at load-time.</li><li>*_GLOB_DAT: global variable.</li><li>*_JMP_SLOT: PLT entry.</li><li>*_RELATIVE: relative to image base of program’s image.</li><li>*_GOTOFF: absolute address within GOT.</li><li>*_GOTPC: program counter relative GOT offset.</li></ul><p>This being said, in the following tables x86 and x86_64 relocation types and their correspondent calculations are defined:</p><p>&nbsp;</p><h4>x86 Relocation types</h4><p>&nbsp;</p><table><tbody><tr><th>Name</th><th>Value</th><th>Field</th><th>Calculation</th></tr><tr><td>R_386_NONE</td><td>0</td><td>None</td><td>None</td></tr><tr><td>R_386_32</td><td>2</td><td>dword</td><td>S + A</td></tr><tr><td>R_386_PC32</td><td>1</td><td>dword</td><td>S + A &#8211; P</td></tr><tr><td>R_386_GOT32</td><td>3</td><td>dword</td><td>G + A</td></tr><tr><td>R_386_PLT32</td><td>4</td><td>dword</td><td>L + A &#8211; P</td></tr><tr><td>R_386_COPY</td><td>5</td><td>None</td><td>Value is copied directly from shared object</td></tr><tr><td>R_386_GLOB_DAT</td><td>6</td><td>dword</td><td>S</td></tr><tr><td>R_386_JMP_SLOT</td><td>7</td><td>dword</td><td>S</td></tr><tr><td>R_386_RELATIVE</td><td>8</td><td>dword</td><td>B + A</td></tr><tr><td>R_386_GOTOFF</td><td>9</td><td>dword</td><td>S + A &#8211; GOT</td></tr><tr><td>R_386_GOTPC</td><td>10</td><td>dword</td><td>GOT + A &#8211; P</td></tr><tr><td>R_386_32PLT</td><td>11</td><td>dword</td><td>L + A</td></tr><tr><td>R_386_16</td><td>20</td><td>word</td><td>S + A</td></tr><tr><td>R_386_PC16</td><td>21</td><td>word</td><td>S + A &#8211; P</td></tr><tr><td>R_386_8</td><td>22</td><td>byte</td><td>S + A</td></tr><tr><td>R_386_PC8</td><td>23</td><td>byte</td><td>S + A &#8211; P</td></tr><tr><td>R_386_SIZE32</td><td>38</td><td>dword</td><td>z + A</td></tr></tbody></table><p>&nbsp;</p><h4>x86_64 Relocation types</h4><p>&nbsp;</p><table><tbody><tr><th>Name</th><th>Value</th><th>Field</th><th>Calculation</th></tr><tr><td>R_X86_64_NONE</td><td>0</td><td>None</td><td>None</td></tr><tr><td>R_X86_64_64</td><td>1</td><td>qword</td><td>S + A</td></tr><tr><td>R_X86_64_PC32</td><td>2</td><td>dword</td><td>S + A &#8211; P</td></tr><tr><td>R_X86_64_GOT32</td><td>3</td><td>dword</td><td>G + A</td></tr><tr><td>R_X86_64_PLT32</td><td>4</td><td>dword</td><td>L + A &#8211; P</td></tr><tr><td>R_X86_64_COPY</td><td>5</td><td>None</td><td>Value is copied directly from shared object</td></tr><tr><td>R_X86_64_GLOB_DAT</td><td>6</td><td>qword</td><td>S</td></tr><tr><td>R_X86_64_JUMP_SLOT</td><td>7</td><td>qword</td><td>S</td></tr><tr><td>R_X86_64_RELATIVE</td><td>8</td><td>qword</td><td>B + A</td></tr><tr><td>R_X86_64_GOTPCREL</td><td>9</td><td>dword</td><td>G + GOT + A &#8211; P</td></tr><tr><td>R_X86_64_32</td><td>10</td><td>dword</td><td>S + A</td></tr><tr><td>R_X86_64_32S</td><td>11</td><td>dword</td><td>S + A</td></tr><tr><td>R_X86_64_16</td><td>12</td><td>word</td><td>S + A</td></tr><tr><td>R_X86_64_PC16</td><td>13</td><td>word</td><td>S + A &#8211; P</td></tr><tr><td>R_X86_64_8</td><td>14</td><td>word8</td><td>S + A</td></tr><tr><td>R_X86_64_PC8</td><td>15</td><td>word8</td><td>S + A &#8211; P</td></tr><tr><td>R_X86_64_PC64</td><td>24</td><td>qword</td><td>S + A &#8211; P</td></tr><tr><td>R_X86_64_GOTOFF64</td><td>25</td><td>qword</td><td>S + A &#8211; GOT</td></tr><tr><td>R_X86_64_GOTPC32</td><td>26</td><td>dword</td><td>GOT + A &#8211; P</td></tr><tr><td>R_X86_64_SIZE32</td><td>32</td><td>dword</td><td>Z + A</td></tr><tr><td>R_X86_64_SIZE64</td><td>33</td><td>qword</td><td>Z + A</td></tr></tbody></table><p>&nbsp;</p><p><strong> 4. Summary:</strong><br /> In this post we covered relocations and their different types and calculations. We also described how relocations and symbols are linked together, among other data structures involved in relocations. In the next post, we will revisit Dynamic linking, and cover it in greater depth.</p></div><div class="author-box-bottom clearfix"><img src="https://intezer.com/wp-content/uploads/2020/01/eJRF6CeP_400x400-60x60.jpg" class="user-photo"><div class="user-bio"><strong> Ignacio Sanmillan</strong><div class="share-author"><a href="https://twitter.com/ulexec" target="_blank" class="twitter-link"><i class="fa fa-twitter" aria-hidden="true"></i></a><a href="https://il.linkedin.com/in/ignacio-sanmillan-1aa244b8" target="_blank" class="linkedin-link"><i class="fa fa-linkedin" aria-hidden="true"></i></a></div><p>Nacho is a security researcher specializing in reverse engineering and malware analysis. Nacho plays a key role in Intezer\'s malware hunting and investigation operations, analyzing and documenting new undetected threats. Some of his latest research involves detecting new Linux malware and finding links between different threat actors. Nacho is an adept ELF researcher, having written numerous papers and conducting projects implementing state-of-the-art obfuscation and anti-analysis techniques in the ELF file format.</p></div></div><div class="post-tags"> <a href="https://intezer.com/tag/elf/" rel="tag">ELF</a></div></div><div class="col-md-2"></div></div></div></div><div class="container narrow"><nav class="post-nav clearfix"><div class="prev-post"> <a href="https://intezer.com/blog/product-updates/new-intezer-service-a-critical-health-check-for-your-organization-intezer-compromise-assessment/" rel="prev"></a><div class="post-link clear"><h4><a href="https://intezer.com/blog/product-updates/new-intezer-service-a-critical-health-check-for-your-organization-intezer-compromise-assessment/" rel="prev">NEW:  Intezer Compromise Assessment Service</a></h4></div></div><div class="next-post"> <a href="https://intezer.com/blog/research/iron-cybercrime-group-under-the-scope-2/" rel="next"></a><div class="post-link clear"><h4><a href="https://intezer.com/blog/research/iron-cybercrime-group-under-the-scope-2/" rel="next">Iron Cybercrime Group Under The Scope</a></h4></div></div></nav><div class="related-posts"><h3>Recomended Articles</h3><ul class="row related-cont"><li class="related-single"> <span class="thumb"> <a href="https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/" title=""><img src="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253-253x139.jpg" alt="Executable and Linkable Format 101 Part 4: Dynamic Linking" class="post-thumb" /></a> </span> <span class="read-time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 7</span> <span class="rt-label rt-postfix"></span></span></span><h4> <a href="https://intezer.com/blog/elf/executable-linkable-format-101-part-4-dynamic-linking/">Executable and Linkable Format 101 Part 4: Dynamic Linking</a></h4> <span class="post-excerpt">This is a new post in our Executable and Linkable Format (ELF) 101 series, where...</span> <span class="post-date">25 June 2019</span></li><li class="related-single"> <span class="thumb"> <a href="https://intezer.com/blog/research/muhstik-botnet-reloaded-new-variants-targeting-phpmyadmin-servers/" title=""><img src="https://intezer.com/wp-content/uploads/2018/11/shutterstock_514969543-253x139.jpg" alt="Muhstik Botnet Reloaded: New Variants Targeting  phpMyAdmin Servers" class="post-thumb" /></a> </span> <span class="read-time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 8</span> <span class="rt-label rt-postfix"></span></span></span><h4> <a href="https://intezer.com/blog/research/muhstik-botnet-reloaded-new-variants-targeting-phpmyadmin-servers/">Muhstik Botnet Reloaded: New Variants Targeting  phpMyAdmin Servers</a></h4> <span class="post-excerpt">The Muhstik botnet was first exposed by Netlab360 researchers in May 2018. This botnet targeted mainly GPON routers....</span> <span class="post-date">12 November 2018</span></li><li class="related-single"> <span class="thumb"> <a href="https://intezer.com/blog/intezer-analyze/elf-support-released-hakai-malware/" title=""><img src="https://intezer.com/wp-content/uploads/2018/01/shutterstock_403254253-253x139.jpg" alt="Intezer Analyze&#x2122; ELF Support Release: Hakai Variant Case Study" class="post-thumb" /></a> </span> <span class="read-time"><span class="span-reading-time rt-reading-time"><span class="rt-label rt-prefix"></span> <span class="rt-time"> 3</span> <span class="rt-label rt-postfix"></span></span></span><h4> <a href="https://intezer.com/blog/intezer-analyze/elf-support-released-hakai-malware/">Intezer Analyze&#x2122; ELF Support Release: Hakai Variant Case Study</a></h4> <span class="post-excerpt">ELF SUPPORT We would like to proudly announce that Intezer Analyze&#x2122; now supports genetic...</span> <span class="post-date">30 August 2018</span></li></ul></div></div></div> <script>$(function(){$('div.single-post-page').find('a').addClass('blog-text-link')});$(document).ready(function(){var blogbtn=$('div.side-blog-btn').offset();var $window=$(window);$window.scroll(function(){if($window.scrollTop()>=blogbtn.top-100){$("div.side-blog-btn").addClass("fixed");$("div.side-blog-share").addClass("fixed")}else if($window.scrollTop()<blogbtn.top-100){$("div.side-blog-btn").removeClass("fixed");$("div.side-blog-share").removeClass("fixed")}})})</script> <footer><div class="container"><div class="row"><div class="footer-logo-cont"><img src="https://intezer.com/wp-content/themes/intezer-v2/images/intezer-logo-b.png" alt="intezer footer logo" title="" class="footer-logo"></div><div class="footer-left"><ul id="menu-footer-1" class="footer-1"><li id="menu-item-247" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-247 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Products" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Products </a><ul role="menu" class="dropdown-menu"><li id="menu-item-1453" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1453 nav-item"><a class="nav-link" title="Intezer Analyze" href="https://intezer.com/intezer-analyze/">Intezer Analyze</a></li><li id="menu-item-7166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7166 nav-item"><a class="nav-link" title="Intezer Protect" href="https://intezer.com/intezer-protect/">Intezer Protect</a></li></ul></li><li id="menu-item-7244" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7244 nav-item"><a class="nav-link" title="Why Intezer" href="https://intezer.com/why-intezer/">Why Intezer</a></li><li id="menu-item-3098" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3098 nav-item"><a class="nav-link" title="Technology" href="https://intezer.com/technology/">Technology</a></li><li id="menu-item-213" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-213 nav-item dropdown"><a class="nav-link dropdown-toggle" title="Company" href="javascript:void(0);" data-toggle="dropdown" aria-haspopup="true">Company </a><ul role="menu" class="dropdown-menu"><li id="menu-item-215" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-215 nav-item"><a class="nav-link" title="About" href="https://intezer.com/about/">About</a></li><li id="menu-item-7167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7167 nav-item"><a class="nav-link" title="Events" href="https://intezer.com/intezer-events/">Events</a></li><li id="menu-item-7168" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7168 nav-item"><a class="nav-link" title="News" href="https://intezer.com/intezer-news/">News</a></li><li id="menu-item-8418" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-8418 nav-item"><a class="nav-link" title="Careers" href="https://intezer.com/careers/">Careers</a></li><li id="menu-item-216" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-216 nav-item"><a class="nav-link" title="Contact us" href="https://intezer.com/contact-us/">Contact us</a></li></ul></li><li id="menu-item-7169" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7169 nav-item"><a class="nav-link" title="Partners" href="https://intezer.com/partners/">Partners</a></li><li id="menu-item-217" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-217 nav-item"><a class="nav-link" title="Blog" href="https://intezer.com/blog/">Blog</a></li><li id="menu-item-2061" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2061 nav-item"><a class="nav-link" title="Resources" href="https://intezer.com/resources/">Resources</a></li></ul></div></div></div></footer><div id="credit"><div class="container"><div> © Intezer.com 2020 All rights reserved<ul id="menu-footer-2" class="footer-2"><li id="menu-item-59" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-59"><a href="https://intezer.com/terms-of-use/">Terms of Use</a></li><li id="menu-item-222" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-222"><a href="https://intezer.com/privacy/">Privacy Policy</a></li></ul><div class="social footer-right"><ul><li><a href="https://www.facebook.com/IntezerLabs/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a href="https://www.linkedin.com/company/intezer-labs" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a href="https://twitter.com/intezerlabs" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a href="https://www.youtube.com/channel/UCt5L5ztHh-C1NCKa6bKjXFQ?view_as=subscriber" target="_blank"><i class="fa fa-youtube" aria-hidden="true"></i></a></li></ul></div></div></div></div>  <script type="text/javascript">$(window).scroll(function(){var nav=$('#main-menu');var top=150;if($(window).scrollTop()>=top){nav.addClass('botborder')}else{nav.removeClass('botborder')}})</script> <script type='text/javascript'>/* <![CDATA[ */ var wpcf7={"apiSettings":{"root":"https:\/\/intezer.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"} /* ]]> */</script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/contact-form-7/includes/js/scripts.js?ver=5.1.7'></script> <script type='text/javascript' src='https://www.google.com/recaptcha/api.js?render=6LewXc8UAAAAADEYz8dYpHTk55uH2MjKqbyc1sXD&#038;ver=3.0'></script> <script type='text/javascript' src='https://intezer.com/wp-content/themes/intezer-v2/js/tether.min.js?ver=5.3.2'></script> <script type='text/javascript' src='https://intezer.com/wp-content/themes/intezer-v2/js/bootstrap.min.js?ver=5.3.2'></script> <script type='text/javascript' src='https://intezer.com/wp-content/themes/intezer-v2/js/main.js?ver=5.3.2'></script> <script type='text/javascript'>/* <![CDATA[ */ var wpcf7cf_global_settings={"ajaxurl":"https:\/\/intezer.com\/wp-admin\/admin-ajax.php"} /* ]]> */</script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/cf7-conditional-fields/js/scripts.js?ver=1.8.3'></script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/simple-lightbox/client/js/prod/lib.core.js?ver=2.8.1'></script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/simple-lightbox/client/js/prod/lib.view.js?ver=2.8.1'></script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/simple-lightbox/themes/baseline/js/prod/client.js?ver=2.8.1'></script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/simple-lightbox/themes/default/js/prod/client.js?ver=2.8.1'></script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/simple-lightbox/template-tags/item/js/prod/tag.item.js?ver=2.8.1'></script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/simple-lightbox/template-tags/ui/js/prod/tag.ui.js?ver=2.8.1'></script> <script type='text/javascript' src='https://intezer.com/wp-content/plugins/simple-lightbox/content-handlers/image/js/prod/handler.image.js?ver=2.8.1'></script> <script type="text/javascript" id="slb_footer">/* <![CDATA[ */ if(!!window.jQuery){(function($){$(document).ready(function(){if(!!window.SLB&&SLB.has_child('View.init')){SLB.View.init({"ui_autofit":!0,"ui_animate":!0,"slideshow_autostart":!1,"slideshow_duration":"6","group_loop":!1,"ui_overlay_opacity":"0.8","ui_title_default":!0,"theme_default":"slb_default","ui_labels":{"loading":"Loading","close":"Close","nav_next":"Next","nav_prev":"Previous","slideshow_start":"Start slideshow","slideshow_stop":"Stop slideshow","group_status":"Item %current% of %total%"}})}
if(!!window.SLB&&SLB.has_child('View.assets')){{$.extend(SLB.View.assets,{"79415679":{"id":null,"type":"image","internal":!0,"source":"http:\/\/intezer.com\/wp-content\/uploads\/2018\/04\/2018-04-23-152639_924x127_scrot.png"},"106003893":{"id":null,"type":"image","internal":!0,"source":"http:\/\/intezer.com\/wp-content\/uploads\/2018\/04\/2018-04-23-152616_451x271_scrot.png"},"1805914420":{"id":null,"type":"image","internal":!0,"source":"http:\/\/intezer.com\/wp-content\/uploads\/2018\/04\/2018-04-23-152545_877x731_scrot.png"}})}}
if(!!window.SLB&&SLB.has_child('View.extend_theme')){SLB.View.extend_theme('slb_baseline',{"name":"Baseline","parent":"","styles":[{"handle":"base","uri":"https:\/\/intezer.com\/wp-content\/plugins\/simple-lightbox\/themes\/baseline\/css\/style.css","deps":[]}],"layout_raw":"<div class=\"slb_container\"><div class=\"slb_content\">{{item.content}}<div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><div class=\"slb_controls\"><span class=\"slb_close\">{{ui.close}}<\/span><span class=\"slb_slideshow\">{{ui.slideshow_control}}<\/span><\/div><div class=\"slb_loading\">{{ui.loading}}<\/div><\/div><div class=\"slb_details\"><div class=\"inner\"><div class=\"slb_data\"><div class=\"slb_data_content\"><span class=\"slb_data_title\">{{item.title}}<\/span><span class=\"slb_group_status\">{{ui.group_status}}<\/span><div class=\"slb_data_desc\">{{item.description}}<\/div><\/div><\/div><div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><\/div><\/div><\/div>"})}if(!!window.SLB&&SLB.has_child('View.extend_theme')){SLB.View.extend_theme('slb_default',{"name":"Default (Light)","parent":"slb_baseline","styles":[{"handle":"base","uri":"https:\/\/intezer.com\/wp-content\/plugins\/simple-lightbox\/themes\/default\/css\/style.css","deps":[]}]})}})})(jQuery)} /* ]]> */</script> <script type="text/javascript" id="slb_context">/* <![CDATA[ */ if(!!window.jQuery){(function($){$(document).ready(function(){if(!!window.SLB){{$.extend(SLB,{"context":["public","user_guest"]})}}})})(jQuery)} /* ]]> */</script> <script type="text/javascript">(function(grecaptcha,sitekey,actions){var wpcf7recaptcha={execute:function(action){grecaptcha.execute(sitekey,{action:action}).then(function(token){var forms=document.getElementsByTagName('form');for(var i=0;i<forms.length;i++){var fields=forms[i].getElementsByTagName('input');for(var j=0;j<fields.length;j++){var field=fields[j];if('g-recaptcha-response'===field.getAttribute('name')){field.setAttribute('value',token);break}}}})},executeOnHomepage:function(){wpcf7recaptcha.execute(actions.homepage)},executeOnContactform:function(){wpcf7recaptcha.execute(actions.contactform)},};grecaptcha.ready(wpcf7recaptcha.executeOnHomepage);document.addEventListener('change',wpcf7recaptcha.executeOnContactform,!1);document.addEventListener('wpcf7submit',wpcf7recaptcha.executeOnHomepage,!1)})(grecaptcha,'6LewXc8UAAAAADEYz8dYpHTk55uH2MjKqbyc1sXD',{"homepage":"homepage","contactform":"contactform"})</script>  <script type="text/javascript">/* <![CDATA[ */ var google_conversion_id=842858921;var google_custom_params=window.google_tag_params;var google_remarketing_only=!0 /* ]]> */</script> <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js"></script> <noscript><div style="display:inline;"> <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/842858921/?guid=ON&amp;script=0"/></div> </noscript>  <script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/5492986.js"></script> </body></html>
<!-- Cached by ezCache -->
<!-- Cache created in 0.90s -->